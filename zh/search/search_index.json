{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u901a\u8fc7\u6b64\u89e3\u51b3\u65b9\u6848\u60a8\u53ef\u4ee5\u5feb\u901f\u5728 AWS \u4e91\u4e0a\u6784\u5efa\u9ad8\u53ef\u7528\u67b6\u6784\u7684 Keycloak \u96c6\u7fa4\uff0c\u7528\u4ee5\u5b9e\u73b0\u6807\u51c6\u5316\u7684\u8eab\u4efd\u548c\u8bbf\u95ee\u63a7\u5236\u7cfb\u7edf\u3002Keycloak \u662f\u4e00\u6b3e\u5f00\u6e90\u7684\u8eab\u4efd\u548c\u8bbf\u95ee\u63a7\u5236\u8f6f\u4ef6\uff0c\u63d0\u4f9b\u5355\u70b9\u767b\u5f55\u529f\u80fd\uff0c\u4ee5\u53ca\u53ef\u81ea\u5b9a\u4e49\u7684\u7528\u6237\u754c\u9762\uff0c\u7528\u4e8e\u767b\u5f55\u3001\u6ce8\u518c\u548c\u5e10\u6237\u7ba1\u7406\u7b49\u3002\u60a8\u53ef\u5c06\u5176\u96c6\u6210\u5230\u73b0\u6709\u7684 LDAP \u548c Azure Active Directory \u670d\u52a1\u5668\u4e2d\uff0c\u4e5f\u53ef\u4ee5\u5c06\u8eab\u4efd\u9a8c\u8bc1\u59d4\u6d3e\u7ed9\u7b2c\u4e09\u65b9\u8eab\u4efd\u63d0\u4f9b\u5546\u3002 \u8be5\u89e3\u51b3\u65b9\u6848\u4e3b\u8981\u5305\u62ec\u4ee5\u4e0b\u7279\u70b9\uff1a \u5355\u70b9\u767b\u5f55 : \u652f\u6301 OpenID Connect\u3001OAuth 2.0 \u548c SAML 2.0 \u6807\u51c6\u534f\u8bae\u3002 \u8eab\u4efd\u548c\u8bbf\u95ee\u7ba1\u7406 : \u63d0\u4f9b\u7528\u6237\u8054\u5408\u3001\u5f3a\u8ba4\u8bc1\u3001\u7528\u6237\u7ba1\u7406\u3001\u7ec6\u7c92\u5ea6\u6388\u6743\u7b49\u3002\u8f7b\u677e\u7684\u6dfb\u52a0\u8eab\u4efd\u9a8c\u8bc1\u5230\u5e94\u7528\u7a0b\u5e8f\u548c\u670d\u52a1\u4e2d\uff0c\u800c\u65e0\u9700\u5904\u7406\u5b58\u50a8\u7528\u6237\u6216\u9a8c\u8bc1\u7528\u6237\u3002 \u672f\u8bed \u4ee5\u4e0b\u662f\u76f8\u5173\u672f\u8bed\u7684\u8bf4\u660e\u3002 \u672f\u8bed \u5168\u79f0 \u63cf\u8ff0 SSO Single-Sign On Single-Sign On \u662f\u4e00\u79cd\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6848\uff0c\u5b83\u5141\u8bb8\u7528\u6237\u4f7f\u7528\u5355\u4e2a ID \u767b\u5f55\u5230\u4efb\u4f55\u4e00\u4e2a\u5173\u4f46\u72ec\u7acb\u7684\u8f6f\u4ef6\u7cfb\u7edf\u4e2d\u3002 OAuth Open Authorization Open Authorization \u662f\u8bbf\u95ee\u6388\u6743\u7684\u5f00\u653e\u6807\u51c6\uff0c\u901a\u5e38\u7528\u4f5c\u4e92\u8054\u7f51\u7528\u6237\u6388\u4e88\u7f51\u7ad9\u6216\u5e94\u7528\u7a0b\u5e8f\u8bbf\u95ee\u5176\u5728\u5176\u5b83\u7f51\u7ad9\u4e0a\u7684\u4fe1\u606f\u4f46\u4e0d\u7ed9\u5bc6\u7801\u7684\u4e00\u79cd\u65b9\u5f0f\u3002 OpenID OpenID OpenID \u662f\u7531\u975e\u8425\u5229\u6027 OpenID \u57fa\u91d1\u4f1a\u63a8\u52a8\u7684\u5f00\u653e\u6807\u51c6\u548c\u53bb\u4e2d\u5fc3\u5316\u7684\u8eab\u4efd\u9a8c\u8bc1\u534f\u8bae\u3002 \u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 OpenID Connect \u3002 ICP Internet Content Provider ICP \u8bb8\u53ef\u8bc1\u662f\u4e2d\u56fd\u5de5\u4e1a\u548c\u4fe1\u606f\u5316\u90e8\uff08MIIT\uff09\u9881\u53d1\u7684\u5141\u8bb8\u4e2d\u56fd\u7f51\u7ad9\u5728\u4e2d\u56fd\u8fd0\u8425\u7684\u8bb8\u53ef\u8bc1\u3002 JWT JSON Web Token JSON Web Token \u662f\u4e00\u79cd\u63d0\u8bae\u7684 Internet \u6807\u51c6\uff0c\u7528\u4e8e\u521b\u5efa\u5177\u6709\u53ef\u9009\u7b7e\u540d\u548c/\u6216\u53ef\u9009\u52a0\u5bc6\u7684\u6570\u636e\uff0c\u5176\u6709\u6548\u8d1f\u8f7d\u5305\u542b\u65ad\u8a00\u4e00\u5b9a\u6570\u91cf\u7684\u58f0\u660e\u7684 JSON\u3002\u4ee4\u724c\u4f7f\u7528\u79c1\u6709\u5bc6\u94a5\u6216\u516c\u94a5/\u79c1\u94a5\u8fdb\u884c\u7b7e\u540d\u3002 LDAP Lightweight Directory Access Protocol Lightweight Directory Access Protocol \u662f\u4e00\u79cd\u5f00\u653e\u7684\u3001\u4f9b\u5e94\u5546\u4e2d\u7acb\u7684\u3001\u884c\u4e1a\u6807\u51c6\u7684\u5e94\u7528\u534f\u8bae\uff0c\u7528\u4e8e\u901a\u8fc7 Internet \u534f\u8bae (IP) \u7f51\u7edc\u8bbf\u95ee\u548c\u7ef4\u62a4\u5206\u5e03\u5f0f\u76ee\u5f55\u4fe1\u606f\u670d\u52a1\u3002 AD Active Directory Active Directory \u662f Microsoft \u4e3a Windows \u57df\u7f51\u7edc\u5f00\u53d1\u7684\u76ee\u5f55\u670d\u52a1\u3002 \u5b83\u4f5c\u4e3a\u4e00\u7ec4\u8fdb\u7a0b\u548c\u670d\u52a1\u5305\u542b\u5728\u5927\u591a\u6570 Windows Server \u64cd\u4f5c\u7cfb\u7edf\u4e2d\u3002 \u672c\u5b9e\u65bd\u6307\u5357\u63cf\u8ff0\u4e86\u5728 AWS \u4e91\u4e2d\u90e8\u7f72 Keycloak \u89e3\u51b3\u65b9\u6848\u7684\u67b6\u6784\u6ce8\u610f\u4e8b\u9879\u548c\u914d\u7f6e\u6b65\u9aa4\u3002\u5b83\u5305\u62ec\u6307\u5411 CloudFormation \u6a21\u677f\u7684\u94fe\u63a5\uff0c\u8fd9\u4e9b\u6a21\u677f\u4f7f\u7528 AWS \u5b89\u5168\u6027\u548c\u53ef\u7528\u6027\u6700\u4f73\u5b9e\u8df5\u6765\u542f\u52a8\u548c\u914d\u7f6e\u90e8\u7f72\u6b64\u89e3\u51b3\u65b9\u6848\u6240\u9700\u7684 AWS \u670d\u52a1\u3002 \u8be5\u6307\u5357\u9762\u5411\u5177\u6709 AWS \u4e91\u67b6\u6784\u5b9e\u8df5\u7ecf\u9a8c\u7684 IT \u67b6\u6784\u5e08\u3001\u5f00\u53d1\u4eba\u5458\u548c DevOps\u3002","title":"\u6982\u8ff0"},{"location":"#_1","text":"\u4ee5\u4e0b\u662f\u76f8\u5173\u672f\u8bed\u7684\u8bf4\u660e\u3002 \u672f\u8bed \u5168\u79f0 \u63cf\u8ff0 SSO Single-Sign On Single-Sign On \u662f\u4e00\u79cd\u8eab\u4efd\u9a8c\u8bc1\u65b9\u6848\uff0c\u5b83\u5141\u8bb8\u7528\u6237\u4f7f\u7528\u5355\u4e2a ID \u767b\u5f55\u5230\u4efb\u4f55\u4e00\u4e2a\u5173\u4f46\u72ec\u7acb\u7684\u8f6f\u4ef6\u7cfb\u7edf\u4e2d\u3002 OAuth Open Authorization Open Authorization \u662f\u8bbf\u95ee\u6388\u6743\u7684\u5f00\u653e\u6807\u51c6\uff0c\u901a\u5e38\u7528\u4f5c\u4e92\u8054\u7f51\u7528\u6237\u6388\u4e88\u7f51\u7ad9\u6216\u5e94\u7528\u7a0b\u5e8f\u8bbf\u95ee\u5176\u5728\u5176\u5b83\u7f51\u7ad9\u4e0a\u7684\u4fe1\u606f\u4f46\u4e0d\u7ed9\u5bc6\u7801\u7684\u4e00\u79cd\u65b9\u5f0f\u3002 OpenID OpenID OpenID \u662f\u7531\u975e\u8425\u5229\u6027 OpenID \u57fa\u91d1\u4f1a\u63a8\u52a8\u7684\u5f00\u653e\u6807\u51c6\u548c\u53bb\u4e2d\u5fc3\u5316\u7684\u8eab\u4efd\u9a8c\u8bc1\u534f\u8bae\u3002 \u6709\u5173\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 OpenID Connect \u3002 ICP Internet Content Provider ICP \u8bb8\u53ef\u8bc1\u662f\u4e2d\u56fd\u5de5\u4e1a\u548c\u4fe1\u606f\u5316\u90e8\uff08MIIT\uff09\u9881\u53d1\u7684\u5141\u8bb8\u4e2d\u56fd\u7f51\u7ad9\u5728\u4e2d\u56fd\u8fd0\u8425\u7684\u8bb8\u53ef\u8bc1\u3002 JWT JSON Web Token JSON Web Token \u662f\u4e00\u79cd\u63d0\u8bae\u7684 Internet \u6807\u51c6\uff0c\u7528\u4e8e\u521b\u5efa\u5177\u6709\u53ef\u9009\u7b7e\u540d\u548c/\u6216\u53ef\u9009\u52a0\u5bc6\u7684\u6570\u636e\uff0c\u5176\u6709\u6548\u8d1f\u8f7d\u5305\u542b\u65ad\u8a00\u4e00\u5b9a\u6570\u91cf\u7684\u58f0\u660e\u7684 JSON\u3002\u4ee4\u724c\u4f7f\u7528\u79c1\u6709\u5bc6\u94a5\u6216\u516c\u94a5/\u79c1\u94a5\u8fdb\u884c\u7b7e\u540d\u3002 LDAP Lightweight Directory Access Protocol Lightweight Directory Access Protocol \u662f\u4e00\u79cd\u5f00\u653e\u7684\u3001\u4f9b\u5e94\u5546\u4e2d\u7acb\u7684\u3001\u884c\u4e1a\u6807\u51c6\u7684\u5e94\u7528\u534f\u8bae\uff0c\u7528\u4e8e\u901a\u8fc7 Internet \u534f\u8bae (IP) \u7f51\u7edc\u8bbf\u95ee\u548c\u7ef4\u62a4\u5206\u5e03\u5f0f\u76ee\u5f55\u4fe1\u606f\u670d\u52a1\u3002 AD Active Directory Active Directory \u662f Microsoft \u4e3a Windows \u57df\u7f51\u7edc\u5f00\u53d1\u7684\u76ee\u5f55\u670d\u52a1\u3002 \u5b83\u4f5c\u4e3a\u4e00\u7ec4\u8fdb\u7a0b\u548c\u670d\u52a1\u5305\u542b\u5728\u5927\u591a\u6570 Windows Server \u64cd\u4f5c\u7cfb\u7edf\u4e2d\u3002 \u672c\u5b9e\u65bd\u6307\u5357\u63cf\u8ff0\u4e86\u5728 AWS \u4e91\u4e2d\u90e8\u7f72 Keycloak \u89e3\u51b3\u65b9\u6848\u7684\u67b6\u6784\u6ce8\u610f\u4e8b\u9879\u548c\u914d\u7f6e\u6b65\u9aa4\u3002\u5b83\u5305\u62ec\u6307\u5411 CloudFormation \u6a21\u677f\u7684\u94fe\u63a5\uff0c\u8fd9\u4e9b\u6a21\u677f\u4f7f\u7528 AWS \u5b89\u5168\u6027\u548c\u53ef\u7528\u6027\u6700\u4f73\u5b9e\u8df5\u6765\u542f\u52a8\u548c\u914d\u7f6e\u90e8\u7f72\u6b64\u89e3\u51b3\u65b9\u6848\u6240\u9700\u7684 AWS \u670d\u52a1\u3002 \u8be5\u6307\u5357\u9762\u5411\u5177\u6709 AWS \u4e91\u67b6\u6784\u5b9e\u8df5\u7ecf\u9a8c\u7684 IT \u67b6\u6784\u5e08\u3001\u5f00\u53d1\u4eba\u5458\u548c DevOps\u3002","title":"\u672f\u8bed"},{"location":"implementation-guide/additional-resources/","text":"AWS Services AWS CloudFormation Amazon ECS Amazon ECR Amazon Certificate Manager (ACM) AWS Identity and Access Management (IAM) Amazon Route 53 Amazon Aurora AWS Secrets Manager Application Load Balancer AWS Fargate","title":"\u66f4\u591a\u8d44\u6e90"},{"location":"implementation-guide/additional-resources/#aws-services","text":"AWS CloudFormation Amazon ECS Amazon ECR Amazon Certificate Manager (ACM) AWS Identity and Access Management (IAM) Amazon Route 53 Amazon Aurora AWS Secrets Manager Application Load Balancer AWS Fargate","title":"AWS Services"},{"location":"implementation-guide/architecture/","text":"\u4f7f\u7528\u9ed8\u8ba4\u53c2\u6570\u90e8\u7f72\u6b64\u89e3\u51b3\u65b9\u6848\u4f1a\u5728 AWS \u4e91\u4e2d\u6784\u5efa\u4ee5\u4e0b\u73af\u5883\u3002 \u56fe1: \u89e3\u51b3\u65b9\u6848\u67b6\u6784\u56fe \u6b64\u89e3\u51b3\u65b9\u6848\u5728\u60a8\u7684 AWS \u4e91\u8d26\u6237\u4e2d\u90e8\u7f72 AWS CloudFormation \u6a21\u677f\u5e76\u5b8c\u6210\u4ee5\u4e0b\u8bbe\u7f6e\u3002 \u5728\u4e24\u4e2a \u53ef\u7528\u533a \u90e8\u7f72\u7684\u9ad8\u53ef\u7528\u67b6\u6784\uff1b \u6839\u636e AWS \u6700\u4f73\u5b9e\u8df5\u5728 Amazon Virtual Private Cloud (Amazon VPC) \u4e2d\u914d\u7f6e\u4e86\u516c\u6709\u548c\u79c1\u6709\u5b50\u7f51\u8fdb\u884c\u8d44\u6e90\u9694\u79bb\uff1b \u5904\u5728\u79c1\u6709\u5b50\u7f51\u4e2d\u7684\u8d44\u6e90\u901a\u8fc7\u516c\u6709\u5b50\u7f51\u4e2d\u7684NAT\u7f51\u5173\u8fde\u63a5\u5230\u4e92\u8054\u7f51\uff0c\u4f46\u4e0d\u80fd\u63a5\u6536\u6765\u81ea\u4e92\u8054\u7f51\u7684\u672a\u7ecf\u8bf7\u6c42\u7684\u5165\u7ad9\u8fde\u63a5\uff1b \u5728\u79c1\u6709\u5b50\u7f51\u4e2d: \u4f7f\u7528 AWS Fargate \u8fd0\u884c\u548c\u6269\u5c55 Amazon ECS \u5bb9\u5668\u5de5\u4f5c\u8d1f\u8f7d\uff1b \u4f7f\u7528 Application Load Balancer \u8d1f\u8f7d\u5747\u8861\u8bf7\u6c42\u6d41\u91cf\uff1b \u90e8\u7f72 Amazon Aurora Serverless MySQL-Compatible \u6216 Amazon Aurora MySQL-Compatible \u6570\u636e\u5e93\u96c6\u7fa4\u3002 \u4e3a Amazon ECS \u670d\u52a1\u521b\u5efa IAM \u89d2\u8272\uff1b \u901a\u8fc7 AWS Secrets Manager \u7ba1\u7406 Keycloak \u63a7\u5236\u53f0\u767b\u5f55\u548c\u6570\u636e\u5e93\u8fde\u63a5\u5bc6\u94a5\uff1b \u901a\u8fc7 AWS Certificate Manager (ACM) \u5c06\u73b0\u6709\u7684\u8bc1\u4e66\u5e94\u7528\u5230 Application Load Balancer \u7684\u57df\u540d\u4e0a\uff1b \u5728 Amazon Route 53 \u4e2d\u6dfb\u52a0\u522b\u540d\u8bb0\u5f55\uff0c\u7528\u4e8e\u8bbf\u95eeKeycloak\u63a7\u5236\u53f0\u3002","title":"\u67b6\u6784\u6982\u89c8"},{"location":"implementation-guide/considerations/","text":"\u76ee\u524d\u672c\u89e3\u51b3\u65b9\u6848\u4f7f\u7528\u7684\u670d\u52a1\u53ef\u80fd\u5e76\u975e\u5728\u6240\u6709\u4e9a\u9a6c\u900a\u4e91\u79d1\u6280\u533a\u57df\u90fd\u53ef\u7528\u3002\u60a8\u9700\u8981\u5728\u63d0\u4f9b\u6240\u9700\u670d\u52a1\u7684\u4e9a\u9a6c\u900a\u4e91\u79d1\u6280\u533a\u57df\u542f\u52a8\u6b64\u89e3\u51b3\u65b9\u6848\u3002\u6709\u5173\u6700\u65b0\u7684\u533a\u57df\u53ef\u7528\u6027\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 AWS \u533a\u57df\u670d\u52a1\u5217\u8868 \u3002 \u56e0\u4e3a\u65b9\u6848\u6709Amazon Aurora MySQL-Compatible\u548cAmazon Aurora Serverless MySQL-Compatible\u53ef\u4f9b\u9009\u62e9\uff0c\u6240\u4ee5\u4f7f\u7528CloudFormation\u90e8\u7f72\u65f6\uff0c\u9700\u8981\u6ce8\u610f\u533a\u57df\u662f\u5426\u652f\u6301Amazon Aurora MySQL-Compatible\u6216Amazon Aurora Serverless MySQL-Compatible\u3002 \u652f\u6301\u90e8\u7f72\u7684\u5168\u7403\u533a\u57df \u533a\u57dfID \u533a\u57df\u540d\u79f0 Amazon Aurora MySQL-Compatible Amazon Aurora Serverless MySQL-Compatible us-east-1 US East (N. Virginia) \u2714 \u2714 us-east-2 US East (Ohio) \u2714 \u2714 us-west-1 US West (N. California) \u2714 \u2714 us-west-2 US West (Oregon) \u2714 \u2714 af-south-1 Asia (Cape Town) \u2714 - ap-south-1 Asia Pacific (Mumbai) \u2714 \u2714 ap-northeast-3 Asia Pacific (Osaka) \u2714 - ap-northeast-2 Asia Pacific (Seoul) \u2714 \u2714 ap-southeast-1 Asia Pacific (Singapore) \u2714 \u2714 ap-southeast-2 Asia Pacific (Sydney) \u2714 \u2714 ap-northeast-1 Asia Pacific (Tokyo) \u2714 \u2714 ca-central-1 Canada (Central) \u2714 \u2714 eu-central-1 Europe (Frankfurt) \u2714 \u2714 eu-west-1 Europe (Ireland) \u2714 \u2714 eu-west-2 Europe (London) \u2714 \u2714 eu-west-3 Europe (Paris) \u2714 \u2714 eu-north-1 Europe (Stockholm) \u2714 - sa-east-1 South America (Sao Paulo) \u2714 - \u652f\u6301\u90e8\u7f72\u7684\u4e2d\u56fd\u533a\u57df \u533a\u57dfID \u533a\u57df\u540d\u79f0 Amazon Aurora MySQL-Compatible Amazon Aurora Serverless MySQL-Compatible cn-north-1 China (Beijing) Region Operated by Sinnet \u2714 - cn-northwest-1 China (Ningxia) Region Operated by NWCD \u2714 \u2714","title":"\u533a\u57df\u652f\u6301"},{"location":"implementation-guide/cost/","text":"\u60a8\u9700\u8981\u627f\u62c5\u8fd0\u884c\u89e3\u51b3\u65b9\u6848\u65f6\u4f7f\u7528\u4e9a\u9a6c\u900a\u4e91\u79d1\u6280\u5404\u4e2a\u670d\u52a1\u7684\u6210\u672c\u8d39\u7528\u3002 \u622a\u81f32022\u5e747\u6708\uff0c\u5f71\u54cd\u89e3\u51b3\u65b9\u6848\u6210\u672c\u7684\u4e3b\u8981\u56e0\u7d20\u5305\u62ec\uff1a AWS Fargate Amazon Aurora MySQL-Compatible Application Load Balancer \u793a\u4f8b 1 \u5047\u8bbe\u60a8\u7684\u6570\u636e\u5e93\u662f Amazon Aurora MySQL-Compatible\uff0c\u4f7f\u7528\u591a\u53ef\u7528\u533a\u96c6\u7fa4\u90e8\u7f72\u3001\u6309\u9700\u4f7f\u7528\u8ba1\u4ef7\u6a21\u5f0f\uff0c\u5728\u7f8e\u56fd\u4e1c\u90e8\uff08\u5f17\u5409\u5c3c\u4e9a\u5317\u90e8\uff09\u533a\u57df\uff08us-east-1\uff09\u4f7f\u7528\u6b64\u89e3\u51b3\u65b9\u6848\u6bcf\u6708\u7684\u6210\u672c\u5982\u4e0b\u6240\u793a\uff1a \u670d\u52a1 \u7528\u91cf \u6210\u672c/\u6708 AWS Fargate 1. 2 \u4e2a ECS \u4efb\u52a1\u6bcf\u5929\u8fd0\u884c 24 \u5c0f\u65f6\uff1b 2. \u6bcf\u4e2a ECS \u4efb\u52a1\u4f7f\u7528 1 vCPU\u30012 GB \u5185\u5b58\u300120 GB \u7684\u4e34\u65f6\u5b58\u50a8\uff1b $ 72.08 Amazon Aurora MySQL-Compatible 1. \u5b9e\u4f8b\u7c7b\u578b\u4e3a db.t3.medium (2 vCPU, 4 GB \u5185\u5b58)\uff1b 2. \u5728\u540c\u4e00\u533a\u57df\u4e0b\u7684\u4e24\u4e2a\u53ef\u7528\u533a\u4e2d\u90e8\u7f72\u5177\u6709\u4e00\u4e2a\u5199\u5165\u5668\u6570\u636e\u5e93\u5b9e\u4f8b\u548c\u4e00\u4e2a\u8bfb\u53d6\u5668\u6570\u636e\u5e93\u5b9e\u4f8b\u7684\u6570\u636e\u5e93\u96c6\u7fa4\uff1b 3. \u6309\u9700\u4f7f\u7528\u8ba1\u4ef7\u6a21\u5f0f\uff1b 4. \u914d\u7f6e 50 GB General Purpose SSD (gp2) \u5b58\u50a8\uff1b 5. \u6bcf\u79d2 30 \u7684\u57fa\u7ebf IO \u901f\u7387\u3001\u6bcf\u79d2 100 \u7684\u5cf0\u503c IO \u901f\u7387\u3001\u6bcf\u6708\u9ad8\u5cf0 IO \u6d3b\u52a8\u6301\u7eed\u65f6\u95f4\u4e3a60\u4e2a\u5c0f\u65f6\uff1b $ 143.51 Application Load Balancer 1. \u6bcf\u6708 100 GB \u5c06 EC2 \u4f5c\u4e3a\u76ee\u6807\u7684\u6d41\u91cf\uff1b 2. \u5e73\u5747\u6bcf\u79d2 40 \u4e2a\u65b0\u8fde\u63a5\uff1b $ 25.77 \u603b\u8ba1 $ 241.36 \u793a\u4f8b 2 \u5047\u8bbe\u60a8\u7684\u6570\u636e\u5e93\u662f Amazon Aurora MySQL-Compatible\uff0c\u4f7f\u7528\u591a\u53ef\u7528\u533a\u96c6\u7fa4\u90e8\u7f72\u3001\u4e00\u5e74\u9884\u7559\u5b9e\u4f8b\u7684\u8ba1\u4ef7\u6a21\u5f0f\uff0c\u5728\u7f8e\u56fd\u4e1c\u90e8\uff08\u5f17\u5409\u5c3c\u4e9a\u5317\u90e8\uff09\u533a\u57df\uff08us-east-1\uff09\u4f7f\u7528\u6b64\u89e3\u51b3\u65b9\u6848\u7684\u6210\u672c\u5982\u4e0b\u6240\u793a\uff1a \u670d\u52a1 \u7528\u91cf \u6210\u672c/\u6708 AWS Fargate 1. 2 \u4e2a ECS \u4efb\u52a1\u6bcf\u5929\u8fd0\u884c 24 \u5c0f\u65f6\uff1b 2. \u6bcf\u4e2a ECS \u4efb\u52a1\u4f7f\u7528 1 vCPU\u30012 GB \u5185\u5b58\u300120 GB \u7684\u4e34\u65f6\u5b58\u50a8\uff1b $ 72.08 Amazon Aurora MySQL-Compatible 1. \u5b9e\u4f8b\u7c7b\u578b\u4e3a db.t3.medium (2 vCPU, 4 GB \u5185\u5b58)\uff1b 2. \u5728\u540c\u4e00\u533a\u57df\u4e0b\u7684\u4e24\u4e2a\u53ef\u7528\u533a\u4e2d\u90e8\u7f72\u5177\u6709\u4e00\u4e2a\u5199\u5165\u5668\u6570\u636e\u5e93\u5b9e\u4f8b\u548c\u4e00\u4e2a\u8bfb\u53d6\u5668\u6570\u636e\u5e93\u5b9e\u4f8b\u7684\u6570\u636e\u5e93\u96c6\u7fa4\uff1b 3. \u4e00\u5e74\u9884\u7559\u5b9e\u4f8b\u7684\u8ba1\u4ef7\u6a21\u5f0f\uff0c\u8d2d\u4e70\u9009\u9879\u4e3a\u9884\u4ed8\u5168\u90e8\u8d39\u7528\uff1b 4. \u914d\u7f6e 50 GB General Purpose SSD (gp2) \u5b58\u50a8\uff1b 5. \u6bcf\u79d2 30 \u7684\u57fa\u7ebf IO \u901f\u7387\u3001\u6bcf\u79d2 100 \u7684\u5cf0\u503c IO \u901f\u7387\u3001\u6bcf\u6708\u9ad8\u5cf0 IO \u6d3b\u52a8\u6301\u7eed\u65f6\u95f4\u4e3a60\u4e2a\u5c0f\u65f6\uff1b $ 103.12 Application Load Balancer 1. \u6bcf\u6708 100 GB \u5c06 EC2 \u4f5c\u4e3a\u76ee\u6807\u7684\u6d41\u91cf\uff1b 2. \u5e73\u5747\u6bcf\u79d2 40 \u4e2a\u65b0\u8fde\u63a5\uff1b $ 25.77 \u603b\u8ba1 $ 200.97 \u793a\u4f8b 3 \u5047\u8bbe\u60a8\u7684\u6570\u636e\u5e93\u662f Amazon Aurora Serverless MySQL-Compatible\uff0c\u5728\u7f8e\u56fd\u4e1c\u90e8\uff08\u5f17\u5409\u5c3c\u4e9a\u5317\u90e8\uff09\u533a\u57df\uff08us-east-1\uff09\u4f7f\u7528\u6b64\u89e3\u51b3\u65b9\u6848\u7684\u6210\u672c\u5982\u4e0b\u6240\u793a\uff1a \u670d\u52a1 \u7528\u91cf \u6210\u672c/\u6708 AWS Fargate 1. 2 \u4e2a ECS \u4efb\u52a1\u6bcf\u5929\u8fd0\u884c 24 \u5c0f\u65f6\uff1b 2. \u6bcf\u4e2a ECS \u4efb\u52a1\u4f7f\u7528 1 vCPU\u30012 GB \u5185\u5b58\u300120 GB \u7684\u4e34\u65f6\u5b58\u50a8\uff1b $ 72.08 Amazon Aurora Serverless MySQL-Compatible 1. \u6bcf\u5929\u4f7f\u7528 12 ACUs\uff1b 2. 50 GB \u7684\u6570\u636e\u5e93\u5b58\u50a8\uff1b 3. \u6bcf\u79d2 30 \u7684\u57fa\u7ebf IO \u901f\u7387\u3001\u6bcf\u79d2 100 \u7684\u5cf0\u503c IO \u901f\u7387\u3001\u6bcf\u6708\u9ad8\u5cf0 IO \u6d3b\u52a8\u6301\u7eed\u65f6\u95f4\u4e3a60\u4e2a\u5c0f\u65f6\uff1b $ 67.59 Application Load Balancer 1. \u6bcf\u6708 100 GB \u5c06 EC2 \u4f5c\u4e3a\u76ee\u6807\u7684\u6d41\u91cf\uff1b 2. \u5e73\u5747\u6bcf\u79d2 40 \u4e2a\u65b0\u8fde\u63a5\uff1b $ 25.77 \u603b\u8ba1 $ 165.44","title":"\u6210\u672c\u9884\u4f30"},{"location":"implementation-guide/cost/#1","text":"\u5047\u8bbe\u60a8\u7684\u6570\u636e\u5e93\u662f Amazon Aurora MySQL-Compatible\uff0c\u4f7f\u7528\u591a\u53ef\u7528\u533a\u96c6\u7fa4\u90e8\u7f72\u3001\u6309\u9700\u4f7f\u7528\u8ba1\u4ef7\u6a21\u5f0f\uff0c\u5728\u7f8e\u56fd\u4e1c\u90e8\uff08\u5f17\u5409\u5c3c\u4e9a\u5317\u90e8\uff09\u533a\u57df\uff08us-east-1\uff09\u4f7f\u7528\u6b64\u89e3\u51b3\u65b9\u6848\u6bcf\u6708\u7684\u6210\u672c\u5982\u4e0b\u6240\u793a\uff1a \u670d\u52a1 \u7528\u91cf \u6210\u672c/\u6708 AWS Fargate 1. 2 \u4e2a ECS \u4efb\u52a1\u6bcf\u5929\u8fd0\u884c 24 \u5c0f\u65f6\uff1b 2. \u6bcf\u4e2a ECS \u4efb\u52a1\u4f7f\u7528 1 vCPU\u30012 GB \u5185\u5b58\u300120 GB \u7684\u4e34\u65f6\u5b58\u50a8\uff1b $ 72.08 Amazon Aurora MySQL-Compatible 1. \u5b9e\u4f8b\u7c7b\u578b\u4e3a db.t3.medium (2 vCPU, 4 GB \u5185\u5b58)\uff1b 2. \u5728\u540c\u4e00\u533a\u57df\u4e0b\u7684\u4e24\u4e2a\u53ef\u7528\u533a\u4e2d\u90e8\u7f72\u5177\u6709\u4e00\u4e2a\u5199\u5165\u5668\u6570\u636e\u5e93\u5b9e\u4f8b\u548c\u4e00\u4e2a\u8bfb\u53d6\u5668\u6570\u636e\u5e93\u5b9e\u4f8b\u7684\u6570\u636e\u5e93\u96c6\u7fa4\uff1b 3. \u6309\u9700\u4f7f\u7528\u8ba1\u4ef7\u6a21\u5f0f\uff1b 4. \u914d\u7f6e 50 GB General Purpose SSD (gp2) \u5b58\u50a8\uff1b 5. \u6bcf\u79d2 30 \u7684\u57fa\u7ebf IO \u901f\u7387\u3001\u6bcf\u79d2 100 \u7684\u5cf0\u503c IO \u901f\u7387\u3001\u6bcf\u6708\u9ad8\u5cf0 IO \u6d3b\u52a8\u6301\u7eed\u65f6\u95f4\u4e3a60\u4e2a\u5c0f\u65f6\uff1b $ 143.51 Application Load Balancer 1. \u6bcf\u6708 100 GB \u5c06 EC2 \u4f5c\u4e3a\u76ee\u6807\u7684\u6d41\u91cf\uff1b 2. \u5e73\u5747\u6bcf\u79d2 40 \u4e2a\u65b0\u8fde\u63a5\uff1b $ 25.77 \u603b\u8ba1 $ 241.36","title":"\u793a\u4f8b 1"},{"location":"implementation-guide/cost/#2","text":"\u5047\u8bbe\u60a8\u7684\u6570\u636e\u5e93\u662f Amazon Aurora MySQL-Compatible\uff0c\u4f7f\u7528\u591a\u53ef\u7528\u533a\u96c6\u7fa4\u90e8\u7f72\u3001\u4e00\u5e74\u9884\u7559\u5b9e\u4f8b\u7684\u8ba1\u4ef7\u6a21\u5f0f\uff0c\u5728\u7f8e\u56fd\u4e1c\u90e8\uff08\u5f17\u5409\u5c3c\u4e9a\u5317\u90e8\uff09\u533a\u57df\uff08us-east-1\uff09\u4f7f\u7528\u6b64\u89e3\u51b3\u65b9\u6848\u7684\u6210\u672c\u5982\u4e0b\u6240\u793a\uff1a \u670d\u52a1 \u7528\u91cf \u6210\u672c/\u6708 AWS Fargate 1. 2 \u4e2a ECS \u4efb\u52a1\u6bcf\u5929\u8fd0\u884c 24 \u5c0f\u65f6\uff1b 2. \u6bcf\u4e2a ECS \u4efb\u52a1\u4f7f\u7528 1 vCPU\u30012 GB \u5185\u5b58\u300120 GB \u7684\u4e34\u65f6\u5b58\u50a8\uff1b $ 72.08 Amazon Aurora MySQL-Compatible 1. \u5b9e\u4f8b\u7c7b\u578b\u4e3a db.t3.medium (2 vCPU, 4 GB \u5185\u5b58)\uff1b 2. \u5728\u540c\u4e00\u533a\u57df\u4e0b\u7684\u4e24\u4e2a\u53ef\u7528\u533a\u4e2d\u90e8\u7f72\u5177\u6709\u4e00\u4e2a\u5199\u5165\u5668\u6570\u636e\u5e93\u5b9e\u4f8b\u548c\u4e00\u4e2a\u8bfb\u53d6\u5668\u6570\u636e\u5e93\u5b9e\u4f8b\u7684\u6570\u636e\u5e93\u96c6\u7fa4\uff1b 3. \u4e00\u5e74\u9884\u7559\u5b9e\u4f8b\u7684\u8ba1\u4ef7\u6a21\u5f0f\uff0c\u8d2d\u4e70\u9009\u9879\u4e3a\u9884\u4ed8\u5168\u90e8\u8d39\u7528\uff1b 4. \u914d\u7f6e 50 GB General Purpose SSD (gp2) \u5b58\u50a8\uff1b 5. \u6bcf\u79d2 30 \u7684\u57fa\u7ebf IO \u901f\u7387\u3001\u6bcf\u79d2 100 \u7684\u5cf0\u503c IO \u901f\u7387\u3001\u6bcf\u6708\u9ad8\u5cf0 IO \u6d3b\u52a8\u6301\u7eed\u65f6\u95f4\u4e3a60\u4e2a\u5c0f\u65f6\uff1b $ 103.12 Application Load Balancer 1. \u6bcf\u6708 100 GB \u5c06 EC2 \u4f5c\u4e3a\u76ee\u6807\u7684\u6d41\u91cf\uff1b 2. \u5e73\u5747\u6bcf\u79d2 40 \u4e2a\u65b0\u8fde\u63a5\uff1b $ 25.77 \u603b\u8ba1 $ 200.97","title":"\u793a\u4f8b 2"},{"location":"implementation-guide/cost/#3","text":"\u5047\u8bbe\u60a8\u7684\u6570\u636e\u5e93\u662f Amazon Aurora Serverless MySQL-Compatible\uff0c\u5728\u7f8e\u56fd\u4e1c\u90e8\uff08\u5f17\u5409\u5c3c\u4e9a\u5317\u90e8\uff09\u533a\u57df\uff08us-east-1\uff09\u4f7f\u7528\u6b64\u89e3\u51b3\u65b9\u6848\u7684\u6210\u672c\u5982\u4e0b\u6240\u793a\uff1a \u670d\u52a1 \u7528\u91cf \u6210\u672c/\u6708 AWS Fargate 1. 2 \u4e2a ECS \u4efb\u52a1\u6bcf\u5929\u8fd0\u884c 24 \u5c0f\u65f6\uff1b 2. \u6bcf\u4e2a ECS \u4efb\u52a1\u4f7f\u7528 1 vCPU\u30012 GB \u5185\u5b58\u300120 GB \u7684\u4e34\u65f6\u5b58\u50a8\uff1b $ 72.08 Amazon Aurora Serverless MySQL-Compatible 1. \u6bcf\u5929\u4f7f\u7528 12 ACUs\uff1b 2. 50 GB \u7684\u6570\u636e\u5e93\u5b58\u50a8\uff1b 3. \u6bcf\u79d2 30 \u7684\u57fa\u7ebf IO \u901f\u7387\u3001\u6bcf\u79d2 100 \u7684\u5cf0\u503c IO \u901f\u7387\u3001\u6bcf\u6708\u9ad8\u5cf0 IO \u6d3b\u52a8\u6301\u7eed\u65f6\u95f4\u4e3a60\u4e2a\u5c0f\u65f6\uff1b $ 67.59 Application Load Balancer 1. \u6bcf\u6708 100 GB \u5c06 EC2 \u4f5c\u4e3a\u76ee\u6807\u7684\u6d41\u91cf\uff1b 2. \u5e73\u5747\u6bcf\u79d2 40 \u4e2a\u65b0\u8fde\u63a5\uff1b $ 25.77 \u603b\u8ba1 $ 165.44","title":"\u793a\u4f8b 3"},{"location":"implementation-guide/deployment/","text":"\u5728\u90e8\u7f72\u89e3\u51b3\u65b9\u6848\u4e4b\u524d\uff0c\u5efa\u8bae\u60a8\u5148\u67e5\u770b\u672c\u6307\u5357\u4e2d\u6709\u5173\u67b6\u6784\u56fe\u548c\u533a\u57df\u652f\u6301\u7b49\u4fe1\u606f\uff0c\u7136\u540e\u6309\u7167\u4e0b\u9762\u7684\u8bf4\u660e\u914d\u7f6e\u89e3\u51b3\u65b9\u6848\u5e76\u5c06\u5176\u90e8\u7f72\u5230\u60a8\u7684\u5e10\u6237\u4e2d\u3002 \u90e8\u7f72\u65f6\u95f4 \uff1a\u5927\u7ea6 30 \u5206\u949f \u524d\u63d0\u6761\u4ef6 \u786e\u4fdd\u60a8\u8981\u90e8\u7f72\u89e3\u51b3\u65b9\u6848\u7684\u76ee\u6807\u533a\u57df\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a \u5df2\u6709\u88ab ICP \u5907\u6848\u5bf9\u57df\u540d\u5e76\u7528\u4e8e\u7533\u8bf7 ACM \u8bc1\u4e66\u3002 \u57df\u540d\u7684\u8bc1\u4e66\u5728 ACM \u4e2d\u521b\u5efa\uff0c\u5e76\u901a\u8fc7\u57df\u540d\u8fdb\u884c\u9a8c\u8bc1\u3002 \u5177\u6709 4 \u4e2a\u5b50\u7f51\uff08\u5305\u62ec\u4e24\u4e2a\u516c\u6709\u5b50\u7f51\u548c\u4e24\u4e2a\u79c1\u6709\u5b50\u7f51\uff09\u548c NAT \u7f51\u5173\u7684 VPC\u3002 \u5728 AWS \u670d\u52a1 \u4e2d\u6240\u5217\u51fa\u7684\u6240\u6709AWS\u670d\u52a1\u5747\u53ef\u7528\u3002 \u90e8\u7f72\u6982\u8ff0 \u4f7f\u7528\u4ee5\u4e0b\u6b65\u9aa4\u5728 AWS \u4e0a\u90e8\u7f72\u6b64\u89e3\u51b3\u65b9\u6848\uff1a \u6b65\u9aa4 1. \u521b\u5efa ACM \u8bc1\u4e66 \u6b65\u9aa4 2. \u9a8c\u8bc1\u57df\u6240\u6709\u6743 \u6b65\u9aa4 3. \u542f\u52a8\u5806\u6808 \u6b65\u9aa4 4. \u5728 Route 53 \u4e2d\u521b\u5efa\u8bb0\u5f55\u4ee5\u89e3\u6790\u57df\u540d \u6b65\u9aa4 5. \u8bbf\u95ee Keycloak Web \u63a7\u5236\u53f0 \u6b65\u9aa4 1. \u521b\u5efa ACM \u8bc1\u4e66 \u4e3a\u4e86\u786e\u4fdd Keycloak \u53ef\u4ee5\u8fde\u63a5\u5230 Cognito \u8eab\u4efd\u6c60\uff0c\u9700\u8981\u786e\u4fdd Keycloak \u63d0\u4f9b HTTPS \u670d\u52a1\u3002\u8fd9\u610f\u5473\u7740\u5fc5\u987b\u4f7f\u7528 ACM \u8bc1\u4e66\u6216\u7b2c\u4e09\u65b9\u8bc1\u4e66\u3002\u6709\u5173\u5982\u4f55\u4f7f\u7528\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u5982\u4f55\u4e0a\u8f7d SSL \u8bc1\u4e66\u5e76\u5c06\u5176\u5bfc\u5165 AWS Identity and Access Management (IAM) \u3002 \u672c\u6307\u5357\u4ee5 AWS Certificate Manager (ACM) \u7684\u4f7f\u7528\u4e3a\u4f8b\u3002\u6709\u5173 ACM \u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Amazon Certificate Manager \u3002 \u767b\u5f55 AWS Certificate Manager \u63a7\u5236\u53f0\u3002 \u5728\u9876\u90e8\u7684\u5bfc\u822a\u680f\u4e2d\uff0c\u9009\u62e9 Keycloak \u60f3\u8981\u90e8\u7f72\u7684 \u533a\u57df \u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\uff0c\u9009\u62e9 \u5217\u51fa\u8bc1\u4e66 \u3002 \u9009\u62e9 \u8bf7\u6c42 \u3002 \u5982\u679c\u60a8\u9009\u62e9\u4ece\u5168\u7403\u533a\u57df\u90e8\u7f72\u89e3\u51b3\u65b9\u6848\uff0c\u4e3a \u8bc1\u4e66\u7c7b\u578b \u9009\u62e9 \u8bf7\u6c42\u516c\u6709\u8bc1\u4e66 \u3002\u5982\u679c\u60a8\u9009\u62e9\u4ece\u4e2d\u56fd\u533a\u57df\u90e8\u7f72\u89e3\u51b3\u65b9\u6848\uff0c\u4ec5\u6709\u4e00\u4e2a\u9009\u9879 \u8bf7\u6c42\u516c\u6709\u8bc1\u4e66 \uff0c\u9009\u62e9\u8be5\u9009\u9879\u3002\u7136\u540e\u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u5728 \u8bf7\u6c42\u516c\u6709\u8bc1\u4e66 \u9875\u9762\uff0c\u5b8c\u6210\u4ee5\u4e0b\u914d\u7f6e\uff1a \u5728 \u57df\u540d \u4e2d\u8f93\u5165\u60a8\u7684 Keycloak \u7684\u57df\u540d\uff0c\u4f8b\u5982 keycloak.yourdomain.com \u3002 \u4fee\u6539 \u9009\u62e9\u9a8c\u8bc1\u65b9\u6cd5 \u4e3a DNS \u9a8c\u8bc1 - \u63a8\u8350 \u3002 \u9009\u62e9 \u8bf7\u6c42 \u3002 \u67e5\u770b \u8bc1\u4e66 \u5217\u8868\uff0c\u65b0\u7533\u8bf7\u7684\u8bc1\u4e66 ID \u7684 \u72b6\u6001 \u5904\u4e8e \u7b49\u5f85\u9a8c\u8bc1 \u3002 \u70b9\u51fb\u65b0\u7533\u8bf7\u7684 \u8bc1\u4e66 ID \u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\u3002\u5728\u65b0\u6253\u5f00\u7684\u9875\u9762\u4e2d\u8bb0\u5f55\u4ee5\u4e0b\u5185\u5bb9\uff1a \u72b6\u6001 \u4e2d\u7684 ARN \u3002 \u57df \u4e2d\u7684 CNAME \u540d\u79f0 \u3002 \u57df \u4e2d\u7684 CNAME \u503c \u3002 \u6b65\u9aa4 2. \u9a8c\u8bc1\u57df\u6240\u6709\u6743 NOTE: \u4ee5\u4e0b\u5185\u5bb9\u662f\u901a\u8fc7 Route 53 \u9a8c\u8bc1\u57df\u540d\u6240\u6709\u6743\u3002\u5982\u679c\u60a8\u4f7f\u7528\u5176\u4ed6\u57df\u540d\u670d\u52a1\u5668 (DNS)\uff0c\u8bf7\u53c2\u8003 DNS \u63d0\u4f9b\u5546\u624b\u518c\u6765\u9a8c\u8bc1\u60a8\u7684\u57df\u540d\u6240\u6709\u6743\u3002 \u5c06 CNAME \u8bb0\u5f55\u6dfb\u52a0\u5230 Route 53 \u4ee5\u9a8c\u8bc1\u57df\u540d\u662f\u5426\u5f52\u60a8\u6240\u6709\u5e76\u53ef\u4f9b\u60a8\u4f7f\u7528\u3002\u5982\u679c\u672a\u521b\u5efa\u6258\u7ba1\u533a\u57df\uff0c\u8bf7\u53c2\u8003 \u5c06 Amazon Route 53 \u914d\u7f6e\u4e3a DNS \u670d\u52a1 \u3002 \u767b\u5f55 Amazon Route 53 \u63a7\u5236\u53f0\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\uff0c\u9009\u62e9 \u6258\u7ba1\u533a\u57df \u3002 \u70b9\u51fb \u57df\u540d \u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\uff0c\u5728\u65b0\u6253\u5f00\u7684\u9875\u9762\u4e2d\u70b9\u51fb \u521b\u5efa\u8bb0\u5f55 \uff0c\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u5728 \u8bb0\u5f55\u540d\u79f0 \u4e2d\u8f93\u5165 \u6b65\u9aa4 1. \u521b\u5efa ACM \u8bc1\u4e66 \u4e2d\u8bb0\u5f55\u7684 CNAME name \uff0c\u4f8b\u5982 _5db1a2688389b3b76ef6e2accaf9a85d.keycloak.yourdomain.com \u3002 \u4fee\u6539 \u8bb0\u5f55\u7c7b\u578b \u4e3a CNAME \u3002 \u5728 \u503c \u4e2d\u8f93\u5165 \u6b65\u9aa4 1. \u521b\u5efa ACM \u8bc1\u4e66 \u4e2d\u8bb0\u5f55\u7684 CNAME value \uff0c\u4f8b\u5982 _1e9108227615sd40f3a767a9dc7a29cb.bpxxncpwjz.acm-validations.aws \u3002 \u9009\u62e9 \u521b\u5efa\u8bb0\u5f55 \u3002 \u8fd4\u56de\u5230 AWS Certificate Manager \u63a7\u5236\u53f0\u5e76\u7b49\u5f85\u5927\u7ea65\u5206\u949f\uff0c\u70b9\u51fb \u5237\u65b0 \u6309\u94ae\uff0c\u76f4\u5230 ACM \u8bc1\u4e66\u7684 \u72b6\u6001 \u53d8\u4e3a \u5df2\u9881\u53d1 \u3002 \u6b65\u9aa4 3. \u542f\u52a8\u5806\u6808 \u4e3a\u6ee1\u8db3\u4e0d\u540c\u7528\u6237\u7684\u9700\u6c42\uff0c\u5171\u6709 4 \u79cd\u90e8\u7f72\u65b9\u5f0f\u4f9b\u60a8\u9009\u62e9\u3002 \u9009\u9879 VPC \u6570\u636e\u5e93 \u5feb\u901f\u542f\u52a8 \u6a21\u677f\u94fe\u63a5 \u9009\u9879\u4e00\uff1a\u4ece\u73b0\u6709\u7684 VPC \u4e2d\u90e8\u7f72\u57fa\u4e8e Aurora Serverless MySQL-Compatible \u7684 Keycloak \u73b0\u6709 Aurora Serverless MySQL-Compatible \u6d77\u5916\u533a\u57df \u4e2d\u56fd\u533a\u57df \u4e0b\u8f7d \u9009\u9879\u4e8c\uff1a\u4ece\u65b0\u7684 VPC \u4e2d\u90e8\u7f72\u57fa\u4e8e Aurora Serverless MySQL-Compatible \u7684 Keycloak \u65b0\u5efa Aurora Serverless MySQL-Compatible \u6d77\u5916\u533a\u57df \u4e2d\u56fd\u533a\u57df \u4e0b\u8f7d \u9009\u9879\u4e09\uff1a\u4ece\u73b0\u6709\u7684 VPC \u4e2d\u90e8\u7f72\u57fa\u4e8e Aurora MySQL-Compatible \u7684 Keycloak \u73b0\u6709 Aurora MySQL-Compatible \u6d77\u5916\u533a\u57df \u4e2d\u56fd\u533a\u57df \u4e0b\u8f7d \u9009\u9879\u56db\uff1a\u4ece\u65b0\u7684 VPC \u4e2d\u90e8\u7f72\u57fa\u4e8e Aurora MySQL-Compatible \u7684 Keycloak \u65b0\u5efa Aurora MySQL-Compatible \u6d77\u5916\u533a\u57df \u4e2d\u56fd\u533a\u57df \u4e0b\u8f7d \u9009\u9879\u4e00\uff1a\u4ece\u73b0\u6709\u7684 VPC \u4e2d\u90e8\u7f72\u57fa\u4e8e Aurora Serverless MySQL-Compatible \u7684 Keycloak \u767b\u5f55 AWS CloudFormation \u63a7\u5236\u53f0\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 \u5806\u6808 \u3002 \u70b9\u51fb \u521b\u5efa\u5806\u6808 \u5e76\u9009\u62e9 \u4f7f\u7528\u65b0\u8d44\u6e90(\u6807\u51c6) \u3002 \u5728 \u6307\u5b9a\u6a21\u677f \u90e8\u5206\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u4fee\u6539 \u51c6\u5907\u6a21\u677f \u4e3a \u6a21\u677f\u5df2\u5c31\u7eea \u3002 \u4fee\u6539 \u6a21\u677f\u6e90 \u4e3a \u4e0a\u4f20\u6a21\u677f\u6587\u4ef6 \u3002 \u70b9\u51fb \u9009\u62e9\u6587\u4ef6 \u5e76\u9009\u62e9\u60a8\u4e0b\u8f7d\u7684\u6a21\u677f\u6587\u4ef6\uff0c\u4f8b\u5982 keycloak-aurora-serverless-from-existing-vpc.template \u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u5728 \u6307\u5b9a\u5806\u6808\u8be6\u7ec6\u4fe1\u606f \u90e8\u5206\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u5806\u6808\u540d\u79f0 : \u8f93\u5165\u5806\u6808\u540d\u79f0, \u4f8b\u5982 KeycloakOnAWS \u3002 CertificateArn : \u8f93\u5165 \u6b65\u9aa4 1. \u521b\u5efa ACM \u8bc1\u4e66 \u4e2d\u8bb0\u5f55\u7684 ARN \uff0c\u4f8b\u5982 arn:aws:acm:us-west-2:1436237113227:certificate/571518b3-123b-4502-1ec3-3t2sae704272 \u3002 VpcId : \u9009\u62e9\u73b0\u6709\u7684VPC \u3002 PubSubnets : \u9009\u62e9\u7528\u4e8e\u90e8\u7f72ALB\u7684\u516c\u6709\u5b50\u7f51\u3002 PrivSubnets : \u9009\u62e9\u7528\u4e8e\u90e8\u7f72ECS\u7684\u79c1\u6709\u5b50\u7f51\u3002 DBSubnets : \u9009\u62e9\u7528\u4e8e\u90e8\u7f72\u6570\u636e\u5e93\u7684\u79c1\u6709\u5b50\u7f51\u3002 MinContainers : ECS\u5bb9\u5668\u7684\u6700\u5c0f\u6570\u91cf\uff0c\u9ed8\u8ba4\u503c\u662f2\u3002 MaxContainers : ECS\u5bb9\u5668\u7684\u6700\u5927\u6570\u91cf\uff0c\u9ed8\u8ba4\u503c\u662f10\u3002 AutoScalingTargetCpuUtilization : \u5f39\u6027\u4f38\u7f29\u7684CPU\u5229\u7528\u7387\u767e\u5206\u6bd4\uff0c\u9ed8\u8ba4\u503c\u662f75\uff0c\u6700\u5927\u503c\u662f100\u3002 JavaOpts : JAVA_OPTS \u53c2\u6570\u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u5728 \u914d\u7f6e\u5806\u6808\u9009\u9879 \u4e2d\u53ef\u4ee5\u6dfb\u52a0 tags \u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u8bc4\u5ba1\u5806\u6808\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u5982\u60a8\u5df2\u786e\u5b9a\u914d\u7f6e\u4fe1\u606f\uff0c\u8bf7\u52fe\u9009 \u6211\u786e\u8ba4\uff0cAmazon CloudFormation \u53ef\u80fd\u521b\u5efa IAM \u8d44\u6e90 \u3002 \u9009\u62e9 \u521b\u5efa\u5806\u6808 \u3002 \u9009\u9879\u4e8c\uff1a\u4ece\u65b0\u7684 VPC \u4e2d\u90e8\u7f72\u57fa\u4e8e Aurora Serverless MySQL-Compatible \u7684 Keycloak \u767b\u5f55 AWS CloudFormation \u63a7\u5236\u53f0\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 \u5806\u6808 \u3002 \u70b9\u51fb \u521b\u5efa\u5806\u6808 \u5e76\u9009\u62e9 \u4f7f\u7528\u65b0\u8d44\u6e90(\u6807\u51c6) \u3002 \u5728 \u6307\u5b9a\u6a21\u677f \u90e8\u5206\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u4fee\u6539 \u51c6\u5907\u6a21\u677f \u4e3a \u6a21\u677f\u5df2\u5c31\u7eea \u3002 \u4fee\u6539 \u6a21\u677f\u6e90 \u4e3a \u4e0a\u4f20\u6a21\u677f\u6587\u4ef6 \u3002 \u70b9\u51fb \u9009\u62e9\u6587\u4ef6 \u5e76\u9009\u62e9\u60a8\u4e0b\u8f7d\u7684\u6a21\u677f\u6587\u4ef6\uff0c\u4f8b\u5982 keycloak-aurora-serverless-from-new-vpc.template \u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u5728 \u6307\u5b9a\u5806\u6808\u8be6\u7ec6\u4fe1\u606f \u90e8\u5206\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u5806\u6808\u540d\u79f0 : \u8f93\u5165\u5806\u6808\u540d\u79f0, \u4f8b\u5982 KeycloakOnAWS \u3002 CertificateArn : \u8f93\u5165 \u6b65\u9aa4 1. \u521b\u5efa ACM \u8bc1\u4e66 \u4e2d\u8bb0\u5f55\u7684 ARN \uff0c\u4f8b\u5982 arn:aws:acm:us-west-2:1436237113227:certificate/571518b3-123b-4502-1ec3-3t2sae704272 \u3002 MinContainers : ECS\u5bb9\u5668\u7684\u6700\u5c0f\u6570\u91cf\uff0c\u9ed8\u8ba4\u503c\u662f2\u3002 MaxContainers : ECS\u5bb9\u5668\u7684\u6700\u5927\u6570\u91cf\uff0c\u9ed8\u8ba4\u503c\u662f10\u3002 AutoScalingTargetCpuUtilization : \u5f39\u6027\u4f38\u7f29\u7684CPU\u5229\u7528\u7387\u767e\u5206\u6bd4\uff0c\u9ed8\u8ba4\u503c\u662f75\uff0c\u6700\u5927\u503c\u662f100\u3002 JavaOpts : JAVA_OPTS \u53c2\u6570\u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u5728 \u914d\u7f6e\u5806\u6808\u9009\u9879 \u4e2d\u53ef\u4ee5\u6dfb\u52a0 tags \u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u8bc4\u5ba1\u5806\u6808\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u5982\u60a8\u5df2\u786e\u5b9a\u914d\u7f6e\u4fe1\u606f\uff0c\u8bf7\u52fe\u9009 \u6211\u786e\u8ba4\uff0cAmazon CloudFormation \u53ef\u80fd\u521b\u5efa IAM \u8d44\u6e90 \u3002 \u9009\u62e9 \u521b\u5efa\u5806\u6808 \u3002 \u9009\u9879\u4e09\uff1a\u4ece\u73b0\u6709\u7684 VPC \u4e2d\u90e8\u7f72\u57fa\u4e8e Aurora MySQL-Compatible \u7684 Keycloak \u767b\u5f55 AWS CloudFormation \u63a7\u5236\u53f0\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 \u5806\u6808 \u3002 \u70b9\u51fb \u521b\u5efa\u5806\u6808 \u5e76\u9009\u62e9 \u4f7f\u7528\u65b0\u8d44\u6e90(\u6807\u51c6) \u3002 \u5728 \u6307\u5b9a\u6a21\u677f \u90e8\u5206\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u4fee\u6539 \u51c6\u5907\u6a21\u677f \u4e3a \u6a21\u677f\u5df2\u5c31\u7eea \u3002 \u4fee\u6539 \u6a21\u677f\u6e90 \u4e3a \u4e0a\u4f20\u6a21\u677f\u6587\u4ef6 \u3002 \u70b9\u51fb \u9009\u62e9\u6587\u4ef6 \u5e76\u9009\u62e9\u60a8\u4e0b\u8f7d\u7684\u6a21\u677f\u6587\u4ef6\uff0c\u4f8b\u5982 keycloak-from-existing-vpc.template \u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u5728 \u6307\u5b9a\u5806\u6808\u8be6\u7ec6\u4fe1\u606f \u90e8\u5206\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u5806\u6808\u540d\u79f0 : \u8f93\u5165\u5806\u6808\u540d\u79f0, \u4f8b\u5982 KeycloakOnAWS \u3002 CertificateArn : \u8f93\u5165 \u6b65\u9aa4 1. \u521b\u5efa ACM \u8bc1\u4e66 \u4e2d\u8bb0\u5f55\u7684 ARN \uff0c\u4f8b\u5982 arn:aws:acm:us-west-2:1436237113227:certificate/571518b3-123b-4502-1ec3-3t2sae704272 \u3002 DatabaseInstanceType : \u9009\u62e9\u6570\u636e\u5e93\u5b9e\u4f8b\u7c7b\u578b\u3002 VpcId : \u9009\u62e9\u73b0\u6709\u7684VPC \u3002 PubSubnets : \u9009\u62e9\u7528\u4e8e\u90e8\u7f72ALB\u7684\u516c\u6709\u5b50\u7f51\u3002 PrivSubnets : \u9009\u62e9\u7528\u4e8e\u90e8\u7f72ECS\u7684\u79c1\u6709\u5b50\u7f51\u3002 DBSubnets : \u9009\u62e9\u7528\u4e8e\u90e8\u7f72\u6570\u636e\u5e93\u7684\u79c1\u6709\u5b50\u7f51\u3002 MinContainers : ECS\u5bb9\u5668\u7684\u6700\u5c0f\u6570\u91cf\uff0c\u9ed8\u8ba4\u503c\u662f2\u3002 MaxContainers : ECS\u5bb9\u5668\u7684\u6700\u5927\u6570\u91cf\uff0c\u9ed8\u8ba4\u503c\u662f10\u3002 AutoScalingTargetCpuUtilization : \u5f39\u6027\u4f38\u7f29\u7684CPU\u5229\u7528\u7387\u767e\u5206\u6bd4\uff0c\u9ed8\u8ba4\u503c\u662f75\uff0c\u6700\u5927\u503c\u662f100\u3002 JavaOpts : JAVA_OPTS \u53c2\u6570\u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u5728 \u7b2c3\u6b65 \u914d\u7f6e\u5806\u6808\u9009\u9879 \u4e2d\u53ef\u4ee5\u6dfb\u52a0 tags \u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u8bc4\u5ba1\u5806\u6808\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u5982\u60a8\u5df2\u786e\u5b9a\u914d\u7f6e\u4fe1\u606f\uff0c\u8bf7\u52fe\u9009 \u6211\u786e\u8ba4\uff0cAmazon CloudFormation \u53ef\u80fd\u521b\u5efa IAM \u8d44\u6e90 \u3002 \u9009\u62e9 \u521b\u5efa\u5806\u6808 \u3002 \u9009\u9879\u56db\uff1a\u4ece\u65b0\u7684 VPC \u4e2d\u90e8\u7f72\u57fa\u4e8e Aurora MySQL-Compatible \u7684 Keycloak \u767b\u5f55 AWS CloudFormation \u63a7\u5236\u53f0\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 \u5806\u6808 \u3002 \u70b9\u51fb \u521b\u5efa\u5806\u6808 \u5e76\u9009\u62e9 \u4f7f\u7528\u65b0\u8d44\u6e90(\u6807\u51c6) \u3002 \u5728 \u6307\u5b9a\u6a21\u677f \u90e8\u5206\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u4fee\u6539 \u51c6\u5907\u6a21\u677f \u4e3a \u6a21\u677f\u5df2\u5c31\u7eea \u3002 \u4fee\u6539 \u6a21\u677f\u6e90 \u4e3a \u4e0a\u4f20\u6a21\u677f\u6587\u4ef6 \u3002 \u70b9\u51fb \u9009\u62e9\u6587\u4ef6 \u5e76\u9009\u62e9\u60a8\u4e0b\u8f7d\u7684\u6a21\u677f\u6587\u4ef6\uff0c\u4f8b\u5982 keycloak-from-new-vpc.template \u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u5728 \u6307\u5b9a\u5806\u6808\u8be6\u7ec6\u4fe1\u606f \u90e8\u5206\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u5806\u6808\u540d\u79f0 : \u8f93\u5165\u5806\u6808\u540d\u79f0, \u4f8b\u5982 KeycloakOnAWS \u3002 CertificateArn : \u8f93\u5165 \u6b65\u9aa4 1. \u521b\u5efa ACM \u8bc1\u4e66 \u4e2d\u8bb0\u5f55\u7684 ARN \uff0c\u4f8b\u5982 arn:aws:acm:us-west-2:1436237113227:certificate/571518b3-123b-4502-1ec3-3t2sae704272 \u3002 DatabaseInstanceType : \u9009\u62e9\u6570\u636e\u5e93\u5b9e\u4f8b\u7c7b\u578b\u3002 MinContainers : ECS\u5bb9\u5668\u7684\u6700\u5c0f\u6570\u91cf\uff0c\u9ed8\u8ba4\u503c\u662f2\u3002 MaxContainers : ECS\u5bb9\u5668\u7684\u6700\u5927\u6570\u91cf\uff0c\u9ed8\u8ba4\u503c\u662f10\u3002 AutoScalingTargetCpuUtilization : \u5f39\u6027\u4f38\u7f29\u7684CPU\u5229\u7528\u7387\u767e\u5206\u6bd4\uff0c\u9ed8\u8ba4\u503c\u662f75\uff0c\u6700\u5927\u503c\u662f100\u3002 JavaOpts : JAVA_OPTS \u53c2\u6570\u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u5728 \u914d\u7f6e\u5806\u6808\u9009\u9879 \u4e2d\u53ef\u4ee5\u6dfb\u52a0 tags \u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u8bc4\u5ba1\u5806\u6808\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u5982\u60a8\u5df2\u786e\u5b9a\u914d\u7f6e\u4fe1\u606f\uff0c\u8bf7\u52fe\u9009 \u6211\u786e\u8ba4\uff0cAmazon CloudFormation \u53ef\u80fd\u521b\u5efa IAM \u8d44\u6e90 \u3002 \u9009\u62e9 \u521b\u5efa\u5806\u6808 \u3002 \u6b65\u9aa4 4. \u5728 Route 53 \u4e2d\u521b\u5efa\u8bb0\u5f55\u4ee5\u89e3\u6790\u57df\u540d \u767b\u5f55 AWS CloudFormation \u63a7\u5236\u53f0\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 \u5806\u6808 \u3002 \u9009\u62e9\u65b0\u5efa\u7684 \u5806\u6808\u540d\u79f0 \u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\u3002 \u9009\u62e9 \u8f93\u51fa \u3002 \u5728\u641c\u7d22\u6846\u4e2d\u8f93\u5165 KeyCloakKeyCloakContainerSerivceEndpointURL \u5e76\u6572\u51fb\u56de\u8f66\uff0c\u590d\u5236\u8fd4\u56de\u7ed3\u679c\u4e2d\u7684 \u503c \uff0c\u4f8b\u5982 Keycl-KeyCl-1WIJGTSV19UTB-541714271.xx-xxx-1.elb.amazonaws.com \u3002 \u767b\u5f55 Amazon Route 53 \u63a7\u5236\u53f0\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 \u6258\u7ba1\u533a\u57df \u3002 \u70b9\u51fb \u57df\u540d \u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\u3002\u5728\u65b0\u6253\u5f00\u7684\u9875\u9762\u4e2d\u70b9\u51fb \u521b\u5efa\u8bb0\u5f55 \u5e76\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c: \u5728 \u8bb0\u5f55\u540d\u79f0 \u4e2d\u8f93\u5165Keycloak\u7684\u5b50\u57df\u540d\uff0c\u4f8b\u5982 keycloak.yourdomain.com \u3002 \u4fee\u6539 \u8bb0\u5f55\u7c7b\u578b \u4e3a CNAME \u3002 \u5728 \u503c \u4e2d\u8f93\u5165\u7b2c5\u6b65\u4e2d\u590d\u5236\u7684 KeyCloakKeyCloakContainerSerivceEndpointURL \u7684 \u503c \uff0c\u4f8b\u5982 Keycl-KeyCl-1WIJGTSV19UTB-541714271.xx-xxx-1.elb.amazonaws.com \u3002 \u9009\u62e9 \u521b\u5efa\u8bb0\u5f55 \u3002 \u6b65\u9aa4 5. \u8bbf\u95ee Keycloak Web \u63a7\u5236\u53f0 \u767b\u5f55 AWS Secrets Manager \u63a7\u5236\u53f0 \u3002 \u5728\u9876\u90e8\u7684\u5bfc\u822a\u680f\u4e2d\u9009\u62e9\u60a8\u7684Keycloak\u90e8\u7f72\u7684 \u533a\u57df \u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 \u5bc6\u94a5 \u3002 \u5728\u8fc7\u6ee4\u6846\u4e2d\u8f93\u5165 KeyCloakKCSecret \u5e76\u6572\u51fb\u56de\u8f66\u3002\u70b9\u51fb\u67e5\u8be2\u51fa\u7684\u7ed3\u679c\uff0c\u4f8b\u5982 KeyCloakKCSecretF8498E5C-VVSujKlsllRI \u3002 \u70b9\u51fb \u5bc6\u94a5\u503c \u4e2d\u7684 \u68c0\u7d22\u5bc6\u94a5\u503c \u6309\u94ae\u3002 \u590d\u5236 username \u548c password \u3002 \u5728\u6d4f\u89c8\u5668\u4e2d\u8f93\u5165 \u60a8\u7684 Keycloak \u57df\u540d \uff0c\u4f8b\u5982 https://keycloak.yourdomain.com \u3002 \u70b9\u51fb Administration Console \u94fe\u63a5 \u3002 \u8f93\u5165\u7b2c6\u6b65\u4e2d\u590d\u5236\u7684 username \u548c password \uff0c\u70b9\u51fb Sign In \u3002","title":"\u90e8\u7f72\u89e3\u51b3\u65b9\u6848"},{"location":"implementation-guide/deployment/#_1","text":"\u786e\u4fdd\u60a8\u8981\u90e8\u7f72\u89e3\u51b3\u65b9\u6848\u7684\u76ee\u6807\u533a\u57df\u6ee1\u8db3\u4ee5\u4e0b\u6761\u4ef6\uff1a \u5df2\u6709\u88ab ICP \u5907\u6848\u5bf9\u57df\u540d\u5e76\u7528\u4e8e\u7533\u8bf7 ACM \u8bc1\u4e66\u3002 \u57df\u540d\u7684\u8bc1\u4e66\u5728 ACM \u4e2d\u521b\u5efa\uff0c\u5e76\u901a\u8fc7\u57df\u540d\u8fdb\u884c\u9a8c\u8bc1\u3002 \u5177\u6709 4 \u4e2a\u5b50\u7f51\uff08\u5305\u62ec\u4e24\u4e2a\u516c\u6709\u5b50\u7f51\u548c\u4e24\u4e2a\u79c1\u6709\u5b50\u7f51\uff09\u548c NAT \u7f51\u5173\u7684 VPC\u3002 \u5728 AWS \u670d\u52a1 \u4e2d\u6240\u5217\u51fa\u7684\u6240\u6709AWS\u670d\u52a1\u5747\u53ef\u7528\u3002","title":"\u524d\u63d0\u6761\u4ef6"},{"location":"implementation-guide/deployment/#_2","text":"\u4f7f\u7528\u4ee5\u4e0b\u6b65\u9aa4\u5728 AWS \u4e0a\u90e8\u7f72\u6b64\u89e3\u51b3\u65b9\u6848\uff1a \u6b65\u9aa4 1. \u521b\u5efa ACM \u8bc1\u4e66 \u6b65\u9aa4 2. \u9a8c\u8bc1\u57df\u6240\u6709\u6743 \u6b65\u9aa4 3. \u542f\u52a8\u5806\u6808 \u6b65\u9aa4 4. \u5728 Route 53 \u4e2d\u521b\u5efa\u8bb0\u5f55\u4ee5\u89e3\u6790\u57df\u540d \u6b65\u9aa4 5. \u8bbf\u95ee Keycloak Web \u63a7\u5236\u53f0","title":"\u90e8\u7f72\u6982\u8ff0"},{"location":"implementation-guide/deployment/#1-acm","text":"\u4e3a\u4e86\u786e\u4fdd Keycloak \u53ef\u4ee5\u8fde\u63a5\u5230 Cognito \u8eab\u4efd\u6c60\uff0c\u9700\u8981\u786e\u4fdd Keycloak \u63d0\u4f9b HTTPS \u670d\u52a1\u3002\u8fd9\u610f\u5473\u7740\u5fc5\u987b\u4f7f\u7528 ACM \u8bc1\u4e66\u6216\u7b2c\u4e09\u65b9\u8bc1\u4e66\u3002\u6709\u5173\u5982\u4f55\u4f7f\u7528\u7684\u8be6\u7ec6\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 \u5982\u4f55\u4e0a\u8f7d SSL \u8bc1\u4e66\u5e76\u5c06\u5176\u5bfc\u5165 AWS Identity and Access Management (IAM) \u3002 \u672c\u6307\u5357\u4ee5 AWS Certificate Manager (ACM) \u7684\u4f7f\u7528\u4e3a\u4f8b\u3002\u6709\u5173 ACM \u7684\u66f4\u591a\u4fe1\u606f\uff0c\u8bf7\u53c2\u9605 Amazon Certificate Manager \u3002 \u767b\u5f55 AWS Certificate Manager \u63a7\u5236\u53f0\u3002 \u5728\u9876\u90e8\u7684\u5bfc\u822a\u680f\u4e2d\uff0c\u9009\u62e9 Keycloak \u60f3\u8981\u90e8\u7f72\u7684 \u533a\u57df \u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\uff0c\u9009\u62e9 \u5217\u51fa\u8bc1\u4e66 \u3002 \u9009\u62e9 \u8bf7\u6c42 \u3002 \u5982\u679c\u60a8\u9009\u62e9\u4ece\u5168\u7403\u533a\u57df\u90e8\u7f72\u89e3\u51b3\u65b9\u6848\uff0c\u4e3a \u8bc1\u4e66\u7c7b\u578b \u9009\u62e9 \u8bf7\u6c42\u516c\u6709\u8bc1\u4e66 \u3002\u5982\u679c\u60a8\u9009\u62e9\u4ece\u4e2d\u56fd\u533a\u57df\u90e8\u7f72\u89e3\u51b3\u65b9\u6848\uff0c\u4ec5\u6709\u4e00\u4e2a\u9009\u9879 \u8bf7\u6c42\u516c\u6709\u8bc1\u4e66 \uff0c\u9009\u62e9\u8be5\u9009\u9879\u3002\u7136\u540e\u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u5728 \u8bf7\u6c42\u516c\u6709\u8bc1\u4e66 \u9875\u9762\uff0c\u5b8c\u6210\u4ee5\u4e0b\u914d\u7f6e\uff1a \u5728 \u57df\u540d \u4e2d\u8f93\u5165\u60a8\u7684 Keycloak \u7684\u57df\u540d\uff0c\u4f8b\u5982 keycloak.yourdomain.com \u3002 \u4fee\u6539 \u9009\u62e9\u9a8c\u8bc1\u65b9\u6cd5 \u4e3a DNS \u9a8c\u8bc1 - \u63a8\u8350 \u3002 \u9009\u62e9 \u8bf7\u6c42 \u3002 \u67e5\u770b \u8bc1\u4e66 \u5217\u8868\uff0c\u65b0\u7533\u8bf7\u7684\u8bc1\u4e66 ID \u7684 \u72b6\u6001 \u5904\u4e8e \u7b49\u5f85\u9a8c\u8bc1 \u3002 \u70b9\u51fb\u65b0\u7533\u8bf7\u7684 \u8bc1\u4e66 ID \u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\u3002\u5728\u65b0\u6253\u5f00\u7684\u9875\u9762\u4e2d\u8bb0\u5f55\u4ee5\u4e0b\u5185\u5bb9\uff1a \u72b6\u6001 \u4e2d\u7684 ARN \u3002 \u57df \u4e2d\u7684 CNAME \u540d\u79f0 \u3002 \u57df \u4e2d\u7684 CNAME \u503c \u3002","title":"\u6b65\u9aa4 1. \u521b\u5efa ACM \u8bc1\u4e66"},{"location":"implementation-guide/deployment/#2","text":"NOTE: \u4ee5\u4e0b\u5185\u5bb9\u662f\u901a\u8fc7 Route 53 \u9a8c\u8bc1\u57df\u540d\u6240\u6709\u6743\u3002\u5982\u679c\u60a8\u4f7f\u7528\u5176\u4ed6\u57df\u540d\u670d\u52a1\u5668 (DNS)\uff0c\u8bf7\u53c2\u8003 DNS \u63d0\u4f9b\u5546\u624b\u518c\u6765\u9a8c\u8bc1\u60a8\u7684\u57df\u540d\u6240\u6709\u6743\u3002 \u5c06 CNAME \u8bb0\u5f55\u6dfb\u52a0\u5230 Route 53 \u4ee5\u9a8c\u8bc1\u57df\u540d\u662f\u5426\u5f52\u60a8\u6240\u6709\u5e76\u53ef\u4f9b\u60a8\u4f7f\u7528\u3002\u5982\u679c\u672a\u521b\u5efa\u6258\u7ba1\u533a\u57df\uff0c\u8bf7\u53c2\u8003 \u5c06 Amazon Route 53 \u914d\u7f6e\u4e3a DNS \u670d\u52a1 \u3002 \u767b\u5f55 Amazon Route 53 \u63a7\u5236\u53f0\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\uff0c\u9009\u62e9 \u6258\u7ba1\u533a\u57df \u3002 \u70b9\u51fb \u57df\u540d \u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\uff0c\u5728\u65b0\u6253\u5f00\u7684\u9875\u9762\u4e2d\u70b9\u51fb \u521b\u5efa\u8bb0\u5f55 \uff0c\u5e76\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u5728 \u8bb0\u5f55\u540d\u79f0 \u4e2d\u8f93\u5165 \u6b65\u9aa4 1. \u521b\u5efa ACM \u8bc1\u4e66 \u4e2d\u8bb0\u5f55\u7684 CNAME name \uff0c\u4f8b\u5982 _5db1a2688389b3b76ef6e2accaf9a85d.keycloak.yourdomain.com \u3002 \u4fee\u6539 \u8bb0\u5f55\u7c7b\u578b \u4e3a CNAME \u3002 \u5728 \u503c \u4e2d\u8f93\u5165 \u6b65\u9aa4 1. \u521b\u5efa ACM \u8bc1\u4e66 \u4e2d\u8bb0\u5f55\u7684 CNAME value \uff0c\u4f8b\u5982 _1e9108227615sd40f3a767a9dc7a29cb.bpxxncpwjz.acm-validations.aws \u3002 \u9009\u62e9 \u521b\u5efa\u8bb0\u5f55 \u3002 \u8fd4\u56de\u5230 AWS Certificate Manager \u63a7\u5236\u53f0\u5e76\u7b49\u5f85\u5927\u7ea65\u5206\u949f\uff0c\u70b9\u51fb \u5237\u65b0 \u6309\u94ae\uff0c\u76f4\u5230 ACM \u8bc1\u4e66\u7684 \u72b6\u6001 \u53d8\u4e3a \u5df2\u9881\u53d1 \u3002","title":"\u6b65\u9aa4 2. \u9a8c\u8bc1\u57df\u6240\u6709\u6743"},{"location":"implementation-guide/deployment/#3","text":"\u4e3a\u6ee1\u8db3\u4e0d\u540c\u7528\u6237\u7684\u9700\u6c42\uff0c\u5171\u6709 4 \u79cd\u90e8\u7f72\u65b9\u5f0f\u4f9b\u60a8\u9009\u62e9\u3002 \u9009\u9879 VPC \u6570\u636e\u5e93 \u5feb\u901f\u542f\u52a8 \u6a21\u677f\u94fe\u63a5 \u9009\u9879\u4e00\uff1a\u4ece\u73b0\u6709\u7684 VPC \u4e2d\u90e8\u7f72\u57fa\u4e8e Aurora Serverless MySQL-Compatible \u7684 Keycloak \u73b0\u6709 Aurora Serverless MySQL-Compatible \u6d77\u5916\u533a\u57df \u4e2d\u56fd\u533a\u57df \u4e0b\u8f7d \u9009\u9879\u4e8c\uff1a\u4ece\u65b0\u7684 VPC \u4e2d\u90e8\u7f72\u57fa\u4e8e Aurora Serverless MySQL-Compatible \u7684 Keycloak \u65b0\u5efa Aurora Serverless MySQL-Compatible \u6d77\u5916\u533a\u57df \u4e2d\u56fd\u533a\u57df \u4e0b\u8f7d \u9009\u9879\u4e09\uff1a\u4ece\u73b0\u6709\u7684 VPC \u4e2d\u90e8\u7f72\u57fa\u4e8e Aurora MySQL-Compatible \u7684 Keycloak \u73b0\u6709 Aurora MySQL-Compatible \u6d77\u5916\u533a\u57df \u4e2d\u56fd\u533a\u57df \u4e0b\u8f7d \u9009\u9879\u56db\uff1a\u4ece\u65b0\u7684 VPC \u4e2d\u90e8\u7f72\u57fa\u4e8e Aurora MySQL-Compatible \u7684 Keycloak \u65b0\u5efa Aurora MySQL-Compatible \u6d77\u5916\u533a\u57df \u4e2d\u56fd\u533a\u57df \u4e0b\u8f7d","title":"\u6b65\u9aa4 3. \u542f\u52a8\u5806\u6808"},{"location":"implementation-guide/deployment/#vpc-aurora-serverless-mysql-compatible-keycloak","text":"\u767b\u5f55 AWS CloudFormation \u63a7\u5236\u53f0\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 \u5806\u6808 \u3002 \u70b9\u51fb \u521b\u5efa\u5806\u6808 \u5e76\u9009\u62e9 \u4f7f\u7528\u65b0\u8d44\u6e90(\u6807\u51c6) \u3002 \u5728 \u6307\u5b9a\u6a21\u677f \u90e8\u5206\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u4fee\u6539 \u51c6\u5907\u6a21\u677f \u4e3a \u6a21\u677f\u5df2\u5c31\u7eea \u3002 \u4fee\u6539 \u6a21\u677f\u6e90 \u4e3a \u4e0a\u4f20\u6a21\u677f\u6587\u4ef6 \u3002 \u70b9\u51fb \u9009\u62e9\u6587\u4ef6 \u5e76\u9009\u62e9\u60a8\u4e0b\u8f7d\u7684\u6a21\u677f\u6587\u4ef6\uff0c\u4f8b\u5982 keycloak-aurora-serverless-from-existing-vpc.template \u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u5728 \u6307\u5b9a\u5806\u6808\u8be6\u7ec6\u4fe1\u606f \u90e8\u5206\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u5806\u6808\u540d\u79f0 : \u8f93\u5165\u5806\u6808\u540d\u79f0, \u4f8b\u5982 KeycloakOnAWS \u3002 CertificateArn : \u8f93\u5165 \u6b65\u9aa4 1. \u521b\u5efa ACM \u8bc1\u4e66 \u4e2d\u8bb0\u5f55\u7684 ARN \uff0c\u4f8b\u5982 arn:aws:acm:us-west-2:1436237113227:certificate/571518b3-123b-4502-1ec3-3t2sae704272 \u3002 VpcId : \u9009\u62e9\u73b0\u6709\u7684VPC \u3002 PubSubnets : \u9009\u62e9\u7528\u4e8e\u90e8\u7f72ALB\u7684\u516c\u6709\u5b50\u7f51\u3002 PrivSubnets : \u9009\u62e9\u7528\u4e8e\u90e8\u7f72ECS\u7684\u79c1\u6709\u5b50\u7f51\u3002 DBSubnets : \u9009\u62e9\u7528\u4e8e\u90e8\u7f72\u6570\u636e\u5e93\u7684\u79c1\u6709\u5b50\u7f51\u3002 MinContainers : ECS\u5bb9\u5668\u7684\u6700\u5c0f\u6570\u91cf\uff0c\u9ed8\u8ba4\u503c\u662f2\u3002 MaxContainers : ECS\u5bb9\u5668\u7684\u6700\u5927\u6570\u91cf\uff0c\u9ed8\u8ba4\u503c\u662f10\u3002 AutoScalingTargetCpuUtilization : \u5f39\u6027\u4f38\u7f29\u7684CPU\u5229\u7528\u7387\u767e\u5206\u6bd4\uff0c\u9ed8\u8ba4\u503c\u662f75\uff0c\u6700\u5927\u503c\u662f100\u3002 JavaOpts : JAVA_OPTS \u53c2\u6570\u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u5728 \u914d\u7f6e\u5806\u6808\u9009\u9879 \u4e2d\u53ef\u4ee5\u6dfb\u52a0 tags \u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u8bc4\u5ba1\u5806\u6808\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u5982\u60a8\u5df2\u786e\u5b9a\u914d\u7f6e\u4fe1\u606f\uff0c\u8bf7\u52fe\u9009 \u6211\u786e\u8ba4\uff0cAmazon CloudFormation \u53ef\u80fd\u521b\u5efa IAM \u8d44\u6e90 \u3002 \u9009\u62e9 \u521b\u5efa\u5806\u6808 \u3002","title":"\u9009\u9879\u4e00\uff1a\u4ece\u73b0\u6709\u7684 VPC \u4e2d\u90e8\u7f72\u57fa\u4e8e Aurora Serverless MySQL-Compatible \u7684 Keycloak"},{"location":"implementation-guide/deployment/#vpc-aurora-serverless-mysql-compatible-keycloak_1","text":"\u767b\u5f55 AWS CloudFormation \u63a7\u5236\u53f0\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 \u5806\u6808 \u3002 \u70b9\u51fb \u521b\u5efa\u5806\u6808 \u5e76\u9009\u62e9 \u4f7f\u7528\u65b0\u8d44\u6e90(\u6807\u51c6) \u3002 \u5728 \u6307\u5b9a\u6a21\u677f \u90e8\u5206\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u4fee\u6539 \u51c6\u5907\u6a21\u677f \u4e3a \u6a21\u677f\u5df2\u5c31\u7eea \u3002 \u4fee\u6539 \u6a21\u677f\u6e90 \u4e3a \u4e0a\u4f20\u6a21\u677f\u6587\u4ef6 \u3002 \u70b9\u51fb \u9009\u62e9\u6587\u4ef6 \u5e76\u9009\u62e9\u60a8\u4e0b\u8f7d\u7684\u6a21\u677f\u6587\u4ef6\uff0c\u4f8b\u5982 keycloak-aurora-serverless-from-new-vpc.template \u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u5728 \u6307\u5b9a\u5806\u6808\u8be6\u7ec6\u4fe1\u606f \u90e8\u5206\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u5806\u6808\u540d\u79f0 : \u8f93\u5165\u5806\u6808\u540d\u79f0, \u4f8b\u5982 KeycloakOnAWS \u3002 CertificateArn : \u8f93\u5165 \u6b65\u9aa4 1. \u521b\u5efa ACM \u8bc1\u4e66 \u4e2d\u8bb0\u5f55\u7684 ARN \uff0c\u4f8b\u5982 arn:aws:acm:us-west-2:1436237113227:certificate/571518b3-123b-4502-1ec3-3t2sae704272 \u3002 MinContainers : ECS\u5bb9\u5668\u7684\u6700\u5c0f\u6570\u91cf\uff0c\u9ed8\u8ba4\u503c\u662f2\u3002 MaxContainers : ECS\u5bb9\u5668\u7684\u6700\u5927\u6570\u91cf\uff0c\u9ed8\u8ba4\u503c\u662f10\u3002 AutoScalingTargetCpuUtilization : \u5f39\u6027\u4f38\u7f29\u7684CPU\u5229\u7528\u7387\u767e\u5206\u6bd4\uff0c\u9ed8\u8ba4\u503c\u662f75\uff0c\u6700\u5927\u503c\u662f100\u3002 JavaOpts : JAVA_OPTS \u53c2\u6570\u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u5728 \u914d\u7f6e\u5806\u6808\u9009\u9879 \u4e2d\u53ef\u4ee5\u6dfb\u52a0 tags \u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u8bc4\u5ba1\u5806\u6808\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u5982\u60a8\u5df2\u786e\u5b9a\u914d\u7f6e\u4fe1\u606f\uff0c\u8bf7\u52fe\u9009 \u6211\u786e\u8ba4\uff0cAmazon CloudFormation \u53ef\u80fd\u521b\u5efa IAM \u8d44\u6e90 \u3002 \u9009\u62e9 \u521b\u5efa\u5806\u6808 \u3002","title":"\u9009\u9879\u4e8c\uff1a\u4ece\u65b0\u7684 VPC \u4e2d\u90e8\u7f72\u57fa\u4e8e Aurora Serverless MySQL-Compatible \u7684 Keycloak"},{"location":"implementation-guide/deployment/#vpc-aurora-mysql-compatible-keycloak","text":"\u767b\u5f55 AWS CloudFormation \u63a7\u5236\u53f0\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 \u5806\u6808 \u3002 \u70b9\u51fb \u521b\u5efa\u5806\u6808 \u5e76\u9009\u62e9 \u4f7f\u7528\u65b0\u8d44\u6e90(\u6807\u51c6) \u3002 \u5728 \u6307\u5b9a\u6a21\u677f \u90e8\u5206\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u4fee\u6539 \u51c6\u5907\u6a21\u677f \u4e3a \u6a21\u677f\u5df2\u5c31\u7eea \u3002 \u4fee\u6539 \u6a21\u677f\u6e90 \u4e3a \u4e0a\u4f20\u6a21\u677f\u6587\u4ef6 \u3002 \u70b9\u51fb \u9009\u62e9\u6587\u4ef6 \u5e76\u9009\u62e9\u60a8\u4e0b\u8f7d\u7684\u6a21\u677f\u6587\u4ef6\uff0c\u4f8b\u5982 keycloak-from-existing-vpc.template \u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u5728 \u6307\u5b9a\u5806\u6808\u8be6\u7ec6\u4fe1\u606f \u90e8\u5206\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u5806\u6808\u540d\u79f0 : \u8f93\u5165\u5806\u6808\u540d\u79f0, \u4f8b\u5982 KeycloakOnAWS \u3002 CertificateArn : \u8f93\u5165 \u6b65\u9aa4 1. \u521b\u5efa ACM \u8bc1\u4e66 \u4e2d\u8bb0\u5f55\u7684 ARN \uff0c\u4f8b\u5982 arn:aws:acm:us-west-2:1436237113227:certificate/571518b3-123b-4502-1ec3-3t2sae704272 \u3002 DatabaseInstanceType : \u9009\u62e9\u6570\u636e\u5e93\u5b9e\u4f8b\u7c7b\u578b\u3002 VpcId : \u9009\u62e9\u73b0\u6709\u7684VPC \u3002 PubSubnets : \u9009\u62e9\u7528\u4e8e\u90e8\u7f72ALB\u7684\u516c\u6709\u5b50\u7f51\u3002 PrivSubnets : \u9009\u62e9\u7528\u4e8e\u90e8\u7f72ECS\u7684\u79c1\u6709\u5b50\u7f51\u3002 DBSubnets : \u9009\u62e9\u7528\u4e8e\u90e8\u7f72\u6570\u636e\u5e93\u7684\u79c1\u6709\u5b50\u7f51\u3002 MinContainers : ECS\u5bb9\u5668\u7684\u6700\u5c0f\u6570\u91cf\uff0c\u9ed8\u8ba4\u503c\u662f2\u3002 MaxContainers : ECS\u5bb9\u5668\u7684\u6700\u5927\u6570\u91cf\uff0c\u9ed8\u8ba4\u503c\u662f10\u3002 AutoScalingTargetCpuUtilization : \u5f39\u6027\u4f38\u7f29\u7684CPU\u5229\u7528\u7387\u767e\u5206\u6bd4\uff0c\u9ed8\u8ba4\u503c\u662f75\uff0c\u6700\u5927\u503c\u662f100\u3002 JavaOpts : JAVA_OPTS \u53c2\u6570\u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u5728 \u7b2c3\u6b65 \u914d\u7f6e\u5806\u6808\u9009\u9879 \u4e2d\u53ef\u4ee5\u6dfb\u52a0 tags \u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u8bc4\u5ba1\u5806\u6808\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u5982\u60a8\u5df2\u786e\u5b9a\u914d\u7f6e\u4fe1\u606f\uff0c\u8bf7\u52fe\u9009 \u6211\u786e\u8ba4\uff0cAmazon CloudFormation \u53ef\u80fd\u521b\u5efa IAM \u8d44\u6e90 \u3002 \u9009\u62e9 \u521b\u5efa\u5806\u6808 \u3002","title":"\u9009\u9879\u4e09\uff1a\u4ece\u73b0\u6709\u7684 VPC \u4e2d\u90e8\u7f72\u57fa\u4e8e Aurora MySQL-Compatible \u7684 Keycloak"},{"location":"implementation-guide/deployment/#vpc-aurora-mysql-compatible-keycloak_1","text":"\u767b\u5f55 AWS CloudFormation \u63a7\u5236\u53f0\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 \u5806\u6808 \u3002 \u70b9\u51fb \u521b\u5efa\u5806\u6808 \u5e76\u9009\u62e9 \u4f7f\u7528\u65b0\u8d44\u6e90(\u6807\u51c6) \u3002 \u5728 \u6307\u5b9a\u6a21\u677f \u90e8\u5206\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u4fee\u6539 \u51c6\u5907\u6a21\u677f \u4e3a \u6a21\u677f\u5df2\u5c31\u7eea \u3002 \u4fee\u6539 \u6a21\u677f\u6e90 \u4e3a \u4e0a\u4f20\u6a21\u677f\u6587\u4ef6 \u3002 \u70b9\u51fb \u9009\u62e9\u6587\u4ef6 \u5e76\u9009\u62e9\u60a8\u4e0b\u8f7d\u7684\u6a21\u677f\u6587\u4ef6\uff0c\u4f8b\u5982 keycloak-from-new-vpc.template \u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u5728 \u6307\u5b9a\u5806\u6808\u8be6\u7ec6\u4fe1\u606f \u90e8\u5206\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a \u5806\u6808\u540d\u79f0 : \u8f93\u5165\u5806\u6808\u540d\u79f0, \u4f8b\u5982 KeycloakOnAWS \u3002 CertificateArn : \u8f93\u5165 \u6b65\u9aa4 1. \u521b\u5efa ACM \u8bc1\u4e66 \u4e2d\u8bb0\u5f55\u7684 ARN \uff0c\u4f8b\u5982 arn:aws:acm:us-west-2:1436237113227:certificate/571518b3-123b-4502-1ec3-3t2sae704272 \u3002 DatabaseInstanceType : \u9009\u62e9\u6570\u636e\u5e93\u5b9e\u4f8b\u7c7b\u578b\u3002 MinContainers : ECS\u5bb9\u5668\u7684\u6700\u5c0f\u6570\u91cf\uff0c\u9ed8\u8ba4\u503c\u662f2\u3002 MaxContainers : ECS\u5bb9\u5668\u7684\u6700\u5927\u6570\u91cf\uff0c\u9ed8\u8ba4\u503c\u662f10\u3002 AutoScalingTargetCpuUtilization : \u5f39\u6027\u4f38\u7f29\u7684CPU\u5229\u7528\u7387\u767e\u5206\u6bd4\uff0c\u9ed8\u8ba4\u503c\u662f75\uff0c\u6700\u5927\u503c\u662f100\u3002 JavaOpts : JAVA_OPTS \u53c2\u6570\u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u5728 \u914d\u7f6e\u5806\u6808\u9009\u9879 \u4e2d\u53ef\u4ee5\u6dfb\u52a0 tags \u3002 \u9009\u62e9 \u4e0b\u4e00\u6b65 \u3002 \u8bc4\u5ba1\u5806\u6808\u7684\u914d\u7f6e\u4fe1\u606f\uff0c\u5982\u60a8\u5df2\u786e\u5b9a\u914d\u7f6e\u4fe1\u606f\uff0c\u8bf7\u52fe\u9009 \u6211\u786e\u8ba4\uff0cAmazon CloudFormation \u53ef\u80fd\u521b\u5efa IAM \u8d44\u6e90 \u3002 \u9009\u62e9 \u521b\u5efa\u5806\u6808 \u3002","title":"\u9009\u9879\u56db\uff1a\u4ece\u65b0\u7684 VPC \u4e2d\u90e8\u7f72\u57fa\u4e8e Aurora MySQL-Compatible \u7684 Keycloak"},{"location":"implementation-guide/deployment/#4-route-53","text":"\u767b\u5f55 AWS CloudFormation \u63a7\u5236\u53f0\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 \u5806\u6808 \u3002 \u9009\u62e9\u65b0\u5efa\u7684 \u5806\u6808\u540d\u79f0 \u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\u3002 \u9009\u62e9 \u8f93\u51fa \u3002 \u5728\u641c\u7d22\u6846\u4e2d\u8f93\u5165 KeyCloakKeyCloakContainerSerivceEndpointURL \u5e76\u6572\u51fb\u56de\u8f66\uff0c\u590d\u5236\u8fd4\u56de\u7ed3\u679c\u4e2d\u7684 \u503c \uff0c\u4f8b\u5982 Keycl-KeyCl-1WIJGTSV19UTB-541714271.xx-xxx-1.elb.amazonaws.com \u3002 \u767b\u5f55 Amazon Route 53 \u63a7\u5236\u53f0\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 \u6258\u7ba1\u533a\u57df \u3002 \u70b9\u51fb \u57df\u540d \u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\u3002\u5728\u65b0\u6253\u5f00\u7684\u9875\u9762\u4e2d\u70b9\u51fb \u521b\u5efa\u8bb0\u5f55 \u5e76\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c: \u5728 \u8bb0\u5f55\u540d\u79f0 \u4e2d\u8f93\u5165Keycloak\u7684\u5b50\u57df\u540d\uff0c\u4f8b\u5982 keycloak.yourdomain.com \u3002 \u4fee\u6539 \u8bb0\u5f55\u7c7b\u578b \u4e3a CNAME \u3002 \u5728 \u503c \u4e2d\u8f93\u5165\u7b2c5\u6b65\u4e2d\u590d\u5236\u7684 KeyCloakKeyCloakContainerSerivceEndpointURL \u7684 \u503c \uff0c\u4f8b\u5982 Keycl-KeyCl-1WIJGTSV19UTB-541714271.xx-xxx-1.elb.amazonaws.com \u3002 \u9009\u62e9 \u521b\u5efa\u8bb0\u5f55 \u3002","title":"\u6b65\u9aa4 4. \u5728 Route 53 \u4e2d\u521b\u5efa\u8bb0\u5f55\u4ee5\u89e3\u6790\u57df\u540d"},{"location":"implementation-guide/deployment/#5-keycloak-web","text":"\u767b\u5f55 AWS Secrets Manager \u63a7\u5236\u53f0 \u3002 \u5728\u9876\u90e8\u7684\u5bfc\u822a\u680f\u4e2d\u9009\u62e9\u60a8\u7684Keycloak\u90e8\u7f72\u7684 \u533a\u57df \u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 \u5bc6\u94a5 \u3002 \u5728\u8fc7\u6ee4\u6846\u4e2d\u8f93\u5165 KeyCloakKCSecret \u5e76\u6572\u51fb\u56de\u8f66\u3002\u70b9\u51fb\u67e5\u8be2\u51fa\u7684\u7ed3\u679c\uff0c\u4f8b\u5982 KeyCloakKCSecretF8498E5C-VVSujKlsllRI \u3002 \u70b9\u51fb \u5bc6\u94a5\u503c \u4e2d\u7684 \u68c0\u7d22\u5bc6\u94a5\u503c \u6309\u94ae\u3002 \u590d\u5236 username \u548c password \u3002 \u5728\u6d4f\u89c8\u5668\u4e2d\u8f93\u5165 \u60a8\u7684 Keycloak \u57df\u540d \uff0c\u4f8b\u5982 https://keycloak.yourdomain.com \u3002 \u70b9\u51fb Administration Console \u94fe\u63a5 \u3002 \u8f93\u5165\u7b2c6\u6b65\u4e2d\u590d\u5236\u7684 username \u548c password \uff0c\u70b9\u51fb Sign In \u3002","title":"\u6b65\u9aa4 5. \u8bbf\u95ee Keycloak Web \u63a7\u5236\u53f0"},{"location":"implementation-guide/revisions/","text":"\u7248\u672c\u66f4\u65b0 Date Description 2022\u5e747\u6708 \u53d1\u5e03\u7248\u672c2.1.0 1. \u5347\u7ea7 Keycloak \u7248\u672c\u81f3 16.1.1 2. \u5347\u7ea7 aws-cdk \u7248\u672c\u81f3 1.160.0 3. \u5347\u7ea7 cdk-keycloak \u7248\u672c\u81f3 0.2.41","title":"\u7248\u672c\u53d1\u5e03\u8bf4\u660e"},{"location":"implementation-guide/revisions/#_1","text":"Date Description 2022\u5e747\u6708 \u53d1\u5e03\u7248\u672c2.1.0 1. \u5347\u7ea7 Keycloak \u7248\u672c\u81f3 16.1.1 2. \u5347\u7ea7 aws-cdk \u7248\u672c\u81f3 1.160.0 3. \u5347\u7ea7 cdk-keycloak \u7248\u672c\u81f3 0.2.41","title":"\u7248\u672c\u66f4\u65b0"},{"location":"implementation-guide/tutorials/ad-ldap/","text":"\u6559\u7a0b: \u5982\u4f55\u5c06 Keycloak \u4e0e AD/LDAP \u96c6\u6210\uff1f Keycloak \u5141\u8bb8\u7528\u6237\u4e0e AD/LDAP \u8054\u5408\u3002\u672c\u6559\u7a0b\u5c06\u5f15\u5bfc\u60a8\u5b8c\u6210\u4f7f\u7528 OpenLDAP \u670d\u52a1\u7684\u7528\u6237\u8054\u5408\u3002\u4e86\u89e3\u66f4\u591a\u4fe1\u606f, \u8bf7\u53c2\u8003 User Federation \u3002 Keycloak \u652f\u6301\u591a\u79cd LDAP \u670d\u52a1\uff0c\u5305\u62ec Microsoft AD \u548c OpenLDAP\u3002\u672c\u6559\u7a0b\u5c06\u5728\u540c\u4e00\u4e2a VPC \u4e2d\u8fd0\u884c\u4e00\u4e2a OpenLDAP \u670d\u52a1\uff0c\u5e76\u5728\u6b64\u6f14\u793a\u4e2d\u4f7f\u7528 Keycloak \u670d\u52a1\u3002 \u524d\u63d0\u6761\u4ef6 \u60a8\u5df2\u7ecf\u901a\u8fc7 AWS CloudFormation \u6216 AWS CDK \u90e8\u7f72\u4e86\u89e3\u51b3\u65b9\u6848\uff0c\u5e76\u4e14\u5df2\u7ecf\u4ee5 Keycloak \u7ba1\u7406\u5458\u7528\u6237\u8eab\u4efd\u6210\u529f\u767b\u5f55\u4e86 Keycloak \u4eea\u8868\u677f\u3002 \u64cd\u4f5c\u6b65\u9aa4 \u6b65\u9aa4 1. \u542f\u52a8\u4e00\u4e2a\u7528\u4e8e\u5b89\u88c5 OpenLDAP \u7684 EC2 \u5b9e\u4f8b \u6b65\u9aa4 2. \u5b89\u88c5 OpenLDAP \u6b65\u9aa4 3. \u5728 Keycloak \u4e0a\u521b\u5efa User Federation \u6b65\u9aa4 4. \u9a8c\u8bc1 User Federation \u6b65\u9aa4 1. \u542f\u52a8\u4e00\u4e2a\u7528\u4e8e\u5b89\u88c5 OpenLDAP \u7684 EC2 \u5b9e\u4f8b \u60a8\u9700\u8981\u5728\u60a8\u7684 Keycloak \u670d\u52a1\u6240\u5728\u7684 VPC \u4e2d\u542f\u52a8 EC2 \u5b9e\u4f8b\uff0c\u7136\u540e\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\u914d\u7f6e\u6b64 EC2 \u5b9e\u4f8b\u7684\u5b89\u5168\u7ec4\uff0c\u5e76\u786e\u4fdd\u6765\u81ea VPC CIDR \u7684\u6240\u6709\u6d41\u91cf\u90fd\u53ef\u4ee5\u8bbf\u95ee\u5176 LDAP \u7aef\u53e3(TCP 389)\u3002 \u6253\u5f00 Amazon EC2 \u63a7\u5236\u53f0\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 Security Groups \u3002 \u5728\u8fc7\u6ee4\u6846\u4e2d\u8f93\u5165 KeyCloakKeyCloakContainer \u540e\u6309\u56de\u8f66\u952e\uff0c\u590d\u5236 Security group ID \uff0c\u4f8b\u5982 sg-0121f1140bbfd72c6 \u3002 \u8fdb\u5165 EC2 \u5b9e\u4f8b\u6240\u5728\u7684\u5b89\u5168\u7ec4\uff0c\u6dfb\u52a0 Inbound rules\uff0c\u5141\u8bb8 ECS \u6240\u5728\u7684\u5b89\u5168\u7ec4\u8bbf\u95ee OpenLDAP \u7684\u7aef\u53e3\u3002 \u70b9\u51fb Save rules \u3002 \u6b65\u9aa4 2. \u5b89\u88c5 OpenLDAP \u5728\u60a8\u7684 EC2 \u5b9e\u4f8b\u4e2d\u4f7f\u7528 Docker \u5b89\u88c5 OpenLDAP\u3002 \u8fde\u63a5\u7ec8\u7aef\u5230\u60a8\u7684 EC2 \u5b9e\u4f8b\u4e0a\u3002 \u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a # \u5b89\u88c5 docker\uff0c\u5e76\u542f\u52a8 docker\u670d\u52a1 yum install -y docker systemctl start docker # \u542f\u52a8 docker \u5bb9\u5668 docker run -p 389:1389 public.ecr.aws/bitnami/openldap:latest \u6253\u5f00\u53e6\u4e00\u4e2a\u7ec8\u7aef\u5e76\u5b89\u88c5OpenLDAP\u5ba2\u6237\u7aef # \u5b89\u88c5LDAP\u5ba2\u6237\u7aef yum install -y openldap-clients # \u67e5\u770b\u6240\u6709\u7528\u6237\u4fe1\u606f ldapsearch -x -b \"ou=users,dc=example,dc=org\" -H ldap://<EC2_PRIVATE_IP> \u793a\u4f8b: [root@xxxx ~]# ldapsearch -x -b \"ou=users,dc=example,dc=org\" -H ldap://<EC2_PRIVATE_IP> # extended LDIF # # LDAPv3 # base <ou=users,dc=example,dc=org> with scope subtree # filter: (objectclass=*) # requesting: ALL # # users, example.org dn: ou=users,dc=example,dc=org objectClass: organizationalUnit ou: users # user01, users, example.org dn: cn=user01,ou=users,dc=example,dc=org cn: User1 cn: user01 sn: Bar1 objectClass: inetOrgPerson objectClass: posixAccount objectClass: shadowAccount userPassword:: Yml0bmFtaTE= uid: user01 uidNumber: 1000 gidNumber: 1000 homeDirectory: /home/user01 # user02, users, example.org dn: cn=user02,ou=users,dc=example,dc=org cn: User2 cn: user02 sn: Bar2 objectClass: inetOrgPerson objectClass: posixAccount objectClass: shadowAccount userPassword:: Yml0bmFtaTI= uid: user02 uidNumber: 1001 gidNumber: 1001 homeDirectory: /home/user02 # readers, users, example.org dn: cn=readers,ou=users,dc=example,dc=org cn: readers objectClass: groupOfNames member: cn=user01,ou=users,dc=example,dc=org member: cn=user02,ou=users,dc=example,dc=org # search result search: 2 result: 0 Success # numResponses: 5 # numEntries: 4 \u73b0\u5728\u60a8\u7684\u9ed8\u8ba4 LDAP \u670d\u52a1\u5df2\u51c6\u5907\u5c31\u7eea\u3002 \u6b65\u9aa4 3. \u5728 Keycloak \u4e0a\u521b\u5efa User Federation \u4ee5 Keycloak \u7ba1\u7406\u5458\u7528\u6237\u8eab\u4efd\u767b\u5f55\u5230 Keycloak \u4eea\u8868\u677f\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\uff0c\u9009\u62e9 User Federation \u3002 \u5728 Add provider \u4e0b\u62c9\u83dc\u5355\u4e2d\u9009\u62e9 ldap \u3002 \u5728\u65b0\u6253\u5f00\u7684\u9875\u9762\u4e2d\u8f93\u5165\u4ee5\u4e0b\u4fe1\u606f: Edit Mode : \u4fee\u6539\u4e3a WRITABLE \u3002 Vendor : \u4fee\u6539\u4e3a Other \u3002 Username LDAP attribute : \u8f93\u5165\u60a8\u7684 LDAP attribute name for username\uff0c\u5728\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528 cn \u3002 RDN LDAP attribute : \u8f93\u5165\u60a8\u7684 LDAP attribute name for user RDN\uff0c\u5728\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528 cn \u3002 UUID LDAP attribute : \u8f93\u5165\u60a8\u7684 LDAP attribute name for UUID\uff0c\u5728\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528 uid \u3002 User Object Classes : \u8f93\u5165\u60a8\u7684 LDAP User Object Classes\uff0c\u5728\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528 inetOrgPerson, posixAccount, shadowAccount \u3002 Connection URL : \u8f93\u5165\u60a8\u7684 LDAP connection URL\uff0c\u5728\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528 ldap://<EC2_PRIVATE_IP> \uff0c\u70b9\u51fb Test connection \u540e\u63d0\u793a \"Success! LDAP connection successful.\" \u4fe1\u606f\u8bf4\u660eLDAP\u8fde\u63a5\u6b63\u5e38\u3002 Users DN : \u8f93\u5165\u60a8\u7684 LDAP Users DN\uff0c\u5728\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528 ou=users,dc=example,dc=org \u3002 Bind Type : \u4fee\u6539\u4e3a simple \u3002 Bind DN : \u8f93\u5165\u60a8\u7684 LDAP bind DN\uff0c\u5728\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528 cn=admin,dc=example,dc=org \u3002 Bind Credential : \u8f93\u5165\u60a8\u7684 LDAP Bind Credentials\uff0c\u5728\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528 adminpassword \uff0c\u70b9\u51fb Test authentication \u540e\u63d0\u793a \"Success! LDAP authentication successful.\" \u4fe1\u606f\u8bf4\u660eLDAP\u8ba4\u8bc1\u6210\u529f\u3002 \u9009\u62e9 Save \u3002 \u9009\u62e9 Synchronize all users \u3002\u9875\u9762\u63d0\u793a\"Success! Sync of users finished successfully. 2 imported users, 0 updated users\"\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 Users \u3002 \u70b9\u51fb View all users \uff0c\u67e5\u770b\u5230 user1 \u548c user2 \u7528\u6237\u8bf4\u660e\u5bfc\u5165\u6210\u529f\u3002 \u6b65\u9aa4 4. \u9a8c\u8bc1 User Federation \u4f7f\u7528 account-console \u767b\u5f55\u9a8c\u8bc1 User Federation\u3002 \u4ee5 Keycloak \u7ba1\u7406\u5458\u7528\u6237\u8eab\u4efd\u767b\u5f55\u5230 Keycloak \u4eea\u8868\u677f\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\uff0c\u9009\u62e9 Clients \u3002 \u9009\u62e9 account-console \u7684 Base URL \u3002 \u60a8\u5c06\u88ab\u91cd\u5b9a\u5411\u5230 Keycloak \u5e10\u6237\u63a7\u5236\u53f0\uff0c\u5355\u51fb\u53f3\u4e0a\u89d2\u7684 Sign In \u6309\u94ae\u3002 \u5728 Username or email \u4e2d\u8f93\u5165 user1 to Username or email\uff0c\u5728 Password\u4e2d\u8f93\u5165 bitnami1 \u3002 \u9009\u62e9 Sign In \u3002\u60a8\u5df2\u7ecf\u6210\u529f\u767b\u5f55\u5230\u63a7\u5236\u53f0\u3002 \u5e38\u89c1\u95ee\u9898\u89e3\u7b54 1. Keycloak \u662f\u5426\u652f\u6301 LDAPS \u534f\u8bae\uff1f \u662f\u7684\u3002Keycloak \u540c\u65f6\u652f\u6301 ldap:// \u548c ldaps://\u3002\u8981\u542f\u7528 ldaps://\uff0c\u8bf7\u786e\u4fdd\u60a8\u7684 AD/LDAP \u4f7f\u7528 LDAPS \u8fd0\u884c\u5e76\u4e14\u5df2\u6b63\u786e\u5bfc\u5165\u8bc1\u4e66\u3002 2. \u5982\u679c\u6211\u6b63\u5728\u8fd0\u884c Microsoft AD \u670d\u52a1\u5668\uff0c\u6211\u5e94\u8be5\u9009\u62e9\u54ea\u79cd\u4f9b\u5e94\u5546\u7c7b\u578b\uff1f \u5728Vendor\u53c2\u6570\u4e2d\u9009\u62e9 Active Directory\u3002","title":"\u5982\u4f55\u5c06 Keycloak \u4e0e AD/LDAP \u96c6\u6210\uff1f"},{"location":"implementation-guide/tutorials/ad-ldap/#keycloak-adldap","text":"Keycloak \u5141\u8bb8\u7528\u6237\u4e0e AD/LDAP \u8054\u5408\u3002\u672c\u6559\u7a0b\u5c06\u5f15\u5bfc\u60a8\u5b8c\u6210\u4f7f\u7528 OpenLDAP \u670d\u52a1\u7684\u7528\u6237\u8054\u5408\u3002\u4e86\u89e3\u66f4\u591a\u4fe1\u606f, \u8bf7\u53c2\u8003 User Federation \u3002 Keycloak \u652f\u6301\u591a\u79cd LDAP \u670d\u52a1\uff0c\u5305\u62ec Microsoft AD \u548c OpenLDAP\u3002\u672c\u6559\u7a0b\u5c06\u5728\u540c\u4e00\u4e2a VPC \u4e2d\u8fd0\u884c\u4e00\u4e2a OpenLDAP \u670d\u52a1\uff0c\u5e76\u5728\u6b64\u6f14\u793a\u4e2d\u4f7f\u7528 Keycloak \u670d\u52a1\u3002","title":"\u6559\u7a0b: \u5982\u4f55\u5c06 Keycloak \u4e0e AD/LDAP \u96c6\u6210\uff1f"},{"location":"implementation-guide/tutorials/ad-ldap/#_1","text":"\u60a8\u5df2\u7ecf\u901a\u8fc7 AWS CloudFormation \u6216 AWS CDK \u90e8\u7f72\u4e86\u89e3\u51b3\u65b9\u6848\uff0c\u5e76\u4e14\u5df2\u7ecf\u4ee5 Keycloak \u7ba1\u7406\u5458\u7528\u6237\u8eab\u4efd\u6210\u529f\u767b\u5f55\u4e86 Keycloak \u4eea\u8868\u677f\u3002","title":"\u524d\u63d0\u6761\u4ef6"},{"location":"implementation-guide/tutorials/ad-ldap/#_2","text":"\u6b65\u9aa4 1. \u542f\u52a8\u4e00\u4e2a\u7528\u4e8e\u5b89\u88c5 OpenLDAP \u7684 EC2 \u5b9e\u4f8b \u6b65\u9aa4 2. \u5b89\u88c5 OpenLDAP \u6b65\u9aa4 3. \u5728 Keycloak \u4e0a\u521b\u5efa User Federation \u6b65\u9aa4 4. \u9a8c\u8bc1 User Federation","title":"\u64cd\u4f5c\u6b65\u9aa4"},{"location":"implementation-guide/tutorials/ad-ldap/#1-openldap-ec2","text":"\u60a8\u9700\u8981\u5728\u60a8\u7684 Keycloak \u670d\u52a1\u6240\u5728\u7684 VPC \u4e2d\u542f\u52a8 EC2 \u5b9e\u4f8b\uff0c\u7136\u540e\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\u914d\u7f6e\u6b64 EC2 \u5b9e\u4f8b\u7684\u5b89\u5168\u7ec4\uff0c\u5e76\u786e\u4fdd\u6765\u81ea VPC CIDR \u7684\u6240\u6709\u6d41\u91cf\u90fd\u53ef\u4ee5\u8bbf\u95ee\u5176 LDAP \u7aef\u53e3(TCP 389)\u3002 \u6253\u5f00 Amazon EC2 \u63a7\u5236\u53f0\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 Security Groups \u3002 \u5728\u8fc7\u6ee4\u6846\u4e2d\u8f93\u5165 KeyCloakKeyCloakContainer \u540e\u6309\u56de\u8f66\u952e\uff0c\u590d\u5236 Security group ID \uff0c\u4f8b\u5982 sg-0121f1140bbfd72c6 \u3002 \u8fdb\u5165 EC2 \u5b9e\u4f8b\u6240\u5728\u7684\u5b89\u5168\u7ec4\uff0c\u6dfb\u52a0 Inbound rules\uff0c\u5141\u8bb8 ECS \u6240\u5728\u7684\u5b89\u5168\u7ec4\u8bbf\u95ee OpenLDAP \u7684\u7aef\u53e3\u3002 \u70b9\u51fb Save rules \u3002","title":"\u6b65\u9aa4 1. \u542f\u52a8\u4e00\u4e2a\u7528\u4e8e\u5b89\u88c5 OpenLDAP \u7684 EC2 \u5b9e\u4f8b"},{"location":"implementation-guide/tutorials/ad-ldap/#2-openldap","text":"\u5728\u60a8\u7684 EC2 \u5b9e\u4f8b\u4e2d\u4f7f\u7528 Docker \u5b89\u88c5 OpenLDAP\u3002 \u8fde\u63a5\u7ec8\u7aef\u5230\u60a8\u7684 EC2 \u5b9e\u4f8b\u4e0a\u3002 \u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a # \u5b89\u88c5 docker\uff0c\u5e76\u542f\u52a8 docker\u670d\u52a1 yum install -y docker systemctl start docker # \u542f\u52a8 docker \u5bb9\u5668 docker run -p 389:1389 public.ecr.aws/bitnami/openldap:latest \u6253\u5f00\u53e6\u4e00\u4e2a\u7ec8\u7aef\u5e76\u5b89\u88c5OpenLDAP\u5ba2\u6237\u7aef # \u5b89\u88c5LDAP\u5ba2\u6237\u7aef yum install -y openldap-clients # \u67e5\u770b\u6240\u6709\u7528\u6237\u4fe1\u606f ldapsearch -x -b \"ou=users,dc=example,dc=org\" -H ldap://<EC2_PRIVATE_IP> \u793a\u4f8b: [root@xxxx ~]# ldapsearch -x -b \"ou=users,dc=example,dc=org\" -H ldap://<EC2_PRIVATE_IP> # extended LDIF # # LDAPv3 # base <ou=users,dc=example,dc=org> with scope subtree # filter: (objectclass=*) # requesting: ALL # # users, example.org dn: ou=users,dc=example,dc=org objectClass: organizationalUnit ou: users # user01, users, example.org dn: cn=user01,ou=users,dc=example,dc=org cn: User1 cn: user01 sn: Bar1 objectClass: inetOrgPerson objectClass: posixAccount objectClass: shadowAccount userPassword:: Yml0bmFtaTE= uid: user01 uidNumber: 1000 gidNumber: 1000 homeDirectory: /home/user01 # user02, users, example.org dn: cn=user02,ou=users,dc=example,dc=org cn: User2 cn: user02 sn: Bar2 objectClass: inetOrgPerson objectClass: posixAccount objectClass: shadowAccount userPassword:: Yml0bmFtaTI= uid: user02 uidNumber: 1001 gidNumber: 1001 homeDirectory: /home/user02 # readers, users, example.org dn: cn=readers,ou=users,dc=example,dc=org cn: readers objectClass: groupOfNames member: cn=user01,ou=users,dc=example,dc=org member: cn=user02,ou=users,dc=example,dc=org # search result search: 2 result: 0 Success # numResponses: 5 # numEntries: 4 \u73b0\u5728\u60a8\u7684\u9ed8\u8ba4 LDAP \u670d\u52a1\u5df2\u51c6\u5907\u5c31\u7eea\u3002","title":"\u6b65\u9aa4 2. \u5b89\u88c5 OpenLDAP"},{"location":"implementation-guide/tutorials/ad-ldap/#3-keycloak-user-federation","text":"\u4ee5 Keycloak \u7ba1\u7406\u5458\u7528\u6237\u8eab\u4efd\u767b\u5f55\u5230 Keycloak \u4eea\u8868\u677f\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\uff0c\u9009\u62e9 User Federation \u3002 \u5728 Add provider \u4e0b\u62c9\u83dc\u5355\u4e2d\u9009\u62e9 ldap \u3002 \u5728\u65b0\u6253\u5f00\u7684\u9875\u9762\u4e2d\u8f93\u5165\u4ee5\u4e0b\u4fe1\u606f: Edit Mode : \u4fee\u6539\u4e3a WRITABLE \u3002 Vendor : \u4fee\u6539\u4e3a Other \u3002 Username LDAP attribute : \u8f93\u5165\u60a8\u7684 LDAP attribute name for username\uff0c\u5728\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528 cn \u3002 RDN LDAP attribute : \u8f93\u5165\u60a8\u7684 LDAP attribute name for user RDN\uff0c\u5728\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528 cn \u3002 UUID LDAP attribute : \u8f93\u5165\u60a8\u7684 LDAP attribute name for UUID\uff0c\u5728\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528 uid \u3002 User Object Classes : \u8f93\u5165\u60a8\u7684 LDAP User Object Classes\uff0c\u5728\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528 inetOrgPerson, posixAccount, shadowAccount \u3002 Connection URL : \u8f93\u5165\u60a8\u7684 LDAP connection URL\uff0c\u5728\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528 ldap://<EC2_PRIVATE_IP> \uff0c\u70b9\u51fb Test connection \u540e\u63d0\u793a \"Success! LDAP connection successful.\" \u4fe1\u606f\u8bf4\u660eLDAP\u8fde\u63a5\u6b63\u5e38\u3002 Users DN : \u8f93\u5165\u60a8\u7684 LDAP Users DN\uff0c\u5728\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528 ou=users,dc=example,dc=org \u3002 Bind Type : \u4fee\u6539\u4e3a simple \u3002 Bind DN : \u8f93\u5165\u60a8\u7684 LDAP bind DN\uff0c\u5728\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528 cn=admin,dc=example,dc=org \u3002 Bind Credential : \u8f93\u5165\u60a8\u7684 LDAP Bind Credentials\uff0c\u5728\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528 adminpassword \uff0c\u70b9\u51fb Test authentication \u540e\u63d0\u793a \"Success! LDAP authentication successful.\" \u4fe1\u606f\u8bf4\u660eLDAP\u8ba4\u8bc1\u6210\u529f\u3002 \u9009\u62e9 Save \u3002 \u9009\u62e9 Synchronize all users \u3002\u9875\u9762\u63d0\u793a\"Success! Sync of users finished successfully. 2 imported users, 0 updated users\"\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 Users \u3002 \u70b9\u51fb View all users \uff0c\u67e5\u770b\u5230 user1 \u548c user2 \u7528\u6237\u8bf4\u660e\u5bfc\u5165\u6210\u529f\u3002","title":"\u6b65\u9aa4 3. \u5728 Keycloak \u4e0a\u521b\u5efa User Federation"},{"location":"implementation-guide/tutorials/ad-ldap/#4-user-federation","text":"\u4f7f\u7528 account-console \u767b\u5f55\u9a8c\u8bc1 User Federation\u3002 \u4ee5 Keycloak \u7ba1\u7406\u5458\u7528\u6237\u8eab\u4efd\u767b\u5f55\u5230 Keycloak \u4eea\u8868\u677f\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\uff0c\u9009\u62e9 Clients \u3002 \u9009\u62e9 account-console \u7684 Base URL \u3002 \u60a8\u5c06\u88ab\u91cd\u5b9a\u5411\u5230 Keycloak \u5e10\u6237\u63a7\u5236\u53f0\uff0c\u5355\u51fb\u53f3\u4e0a\u89d2\u7684 Sign In \u6309\u94ae\u3002 \u5728 Username or email \u4e2d\u8f93\u5165 user1 to Username or email\uff0c\u5728 Password\u4e2d\u8f93\u5165 bitnami1 \u3002 \u9009\u62e9 Sign In \u3002\u60a8\u5df2\u7ecf\u6210\u529f\u767b\u5f55\u5230\u63a7\u5236\u53f0\u3002","title":"\u6b65\u9aa4 4. \u9a8c\u8bc1 User Federation"},{"location":"implementation-guide/tutorials/ad-ldap/#_3","text":"1. Keycloak \u662f\u5426\u652f\u6301 LDAPS \u534f\u8bae\uff1f \u662f\u7684\u3002Keycloak \u540c\u65f6\u652f\u6301 ldap:// \u548c ldaps://\u3002\u8981\u542f\u7528 ldaps://\uff0c\u8bf7\u786e\u4fdd\u60a8\u7684 AD/LDAP \u4f7f\u7528 LDAPS \u8fd0\u884c\u5e76\u4e14\u5df2\u6b63\u786e\u5bfc\u5165\u8bc1\u4e66\u3002 2. \u5982\u679c\u6211\u6b63\u5728\u8fd0\u884c Microsoft AD \u670d\u52a1\u5668\uff0c\u6211\u5e94\u8be5\u9009\u62e9\u54ea\u79cd\u4f9b\u5e94\u5546\u7c7b\u578b\uff1f \u5728Vendor\u53c2\u6570\u4e2d\u9009\u62e9 Active Directory\u3002","title":"\u5e38\u89c1\u95ee\u9898\u89e3\u7b54"},{"location":"implementation-guide/tutorials/api-gateway/","text":"\u6559\u7a0b: \u5982\u4f55\u5c06 Keycloak \u4e0e Amazon API Gateway \u96c6\u6210\uff1f \u672c\u6559\u7a0b\u4ecb\u7ecd\u5982\u4f55\u901a\u8fc7 Keycloak \u63a7\u5236\u4e0d\u540c\u7528\u6237\u8bbf\u95ee\u4e0d\u540cAPI\u63a5\u53e3\u7684\u6743\u9650\u3002\u66f4\u591a\u4fe1\u606f\u53ef\u4ee5\u53c2\u8003 Keycloak \u6587\u6863\u7684 Authorization Services \u7ae0\u8282\u3002 \u67b6\u6784\u56fe \u524d\u63d0\u6761\u4ef6 \u60a8\u5df2\u7ecf\u901a\u8fc7 AWS CloudFormation \u6216 AWS CDK \u90e8\u7f72\u4e86\u89e3\u51b3\u65b9\u6848\uff0c\u5e76\u4e14\u5df2\u7ecf\u4ee5 Keycloak \u7ba1\u7406\u5458\u7528\u6237\u8eab\u4efd\u6210\u529f\u767b\u5f55 Keycloak \u4eea\u8868\u677f\u3002 \u786e\u4fdd\u5728 CloudFormation \u53c2\u6570\u4e2d\u586b\u5199\u4e86\u4ee5\u4e0b JAVA_OPTS\u3002 -Dkeycloak.profile.feature.scripts=enabled -Dkeycloak.profile.feature.upload_scripts=enabled \u64cd\u4f5c\u6b65\u9aa4 \u6b65\u9aa4 1. \u514b\u9686keycloak-on-aws\u4ee3\u7801\u81f3\u672c\u5730 \u6b65\u9aa4 2. \u5bfc\u5165Keycloak\u793a\u4f8b\u914d\u7f6e\u6587\u4ef6 \u6b65\u9aa4 3. \u5728\u672c\u5730\u73af\u5883\u8fd0\u884cserverless-express-auth \u6b65\u9aa4 4. \u5728\u672c\u5730\u73af\u5883\u8fd0\u884cVue UI \u6b65\u9aa4 5. \u9a8c\u8bc1\u7528\u6237\u6743\u9650 \u6b65\u9aa4 1. \u514b\u9686keycloak-on-aws\u4ee3\u7801\u81f3\u672c\u5730 \u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u5c06 keycloak-on-aws \u4ee3\u7801\u4e0b\u8f7d\u5230\u672c\u5730\u3002 git clone https://github.com/aws-samples/keycloak-on-aws.git cd keycloak-on-aws \u6b65\u9aa4 2. \u5bfc\u5165Keycloak\u793a\u4f8b\u914d\u7f6e\u6587\u4ef6 \u4ee5 Keycloak \u7ba1\u7406\u5458\u7528\u6237\u8eab\u4efd\u767b\u5f55 Keycloak \u4eea\u8868\u677f\u3002 \u5728\u5de6\u4fa7\u5bfc\u822a\u7a97\u4e2d\u7684 Master \uff0c\u9009\u62e9 Add realm \u3002 \u9009\u62e9 Select file \uff0c\u9009\u4e2d\u6b65\u9aa4 1 \u4e0b\u8f7d\u4ee3\u7801\u4e2d\u7684 tutorials/api-gateway/resoures/realm-export.json \u6587\u4ef6 \u3002 \u9009\u62e9 Create \u3002 \u6b65\u9aa4 3. \u5728\u672c\u5730\u73af\u5883\u8fd0\u884cserverless-express-auth \u8be5\u793a\u4f8b\u4e3b\u8981\u57fa\u4e8e expressjs \u548c\u5b98\u65b9\u7684 keycloak-nodejs-connect \uff0c\u5e76\u4f7f\u7528 serverless-express \u4ece\u800c\u8ba9 expressjs \u80fd\u591f\u5728 Lambda \u4e0a\u8fd0\u884c\u3002 keycloak-nodejs-connect \u7531 Keycloak \u56e2\u961f\u7ef4\u62a4\uff0c\u8fd9\u662f\u8fde\u63a5\u5230 Keycloak \u7684\u63a8\u8350\u65b9\u5f0f\u3002 \u8bf4\u660e keycloak-nodejs-connect\u7684\u6587\u4ef6\u4f4d\u4e8e https://www.keycloak.org/docs/latest/securing_apps/#_nodejs_adapter\u3002 \u4ee5 Keycloak \u7ba1\u7406\u5458\u7528\u6237\u8eab\u4efd\u767b\u5f55 Keycloak \u4eea\u8868\u677f\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 Clients \u3002 \u9009\u62e9 vue \u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\u3002 \u9009\u62e9 Installation \u3002 \u70b9\u51fb Format Option \u4e0b\u62c9\u83dc\u5355\u5e76\u9009\u62e9 Keycloak OIDC JSON \u3002 \u6839\u636e Keyloak Installation \u4e2d\u7684\u914d\u7f6e\u66f4\u65b0\u6b65\u9aa4 1 \u4e0b\u8f7d\u4ee3\u7801\u4e2d tutorials/api-gateway/resources/realm-export.json \u6587\u4ef6\u5185\u5bb9 \u3002 { \"realm\": \"keycloak-on-aws\", \"auth-server-url\": \"https://keycloak.yourdomain.com/auth/\", \"ssl-required\": \"external\", \"resource\": \"vue\", \"public-client\": true, \"confidential-port\": 0, // Don't remove the following line, this is for vue-ui to contact to api gw !!! \"x-api-gw-url\": \"http://localhost:3003/dev/hello\" } \u8fdb\u5165 tutorials/api-gateway/serverless-express-auth \u76ee\u5f55\uff0c\u5e76\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a cd tutorials/api-gateway/serverless-express-auth yarn yarn offline \u8f93\u51fa\u793a\u4f8b yarn run v1.22.19 $ SLS_DEBUG=* serverless offline --host 0.0.0.0 --httpPort 3003 --lambdaPort=3019 ... offline: Offline [http for lambda] listening on http://0.0.0.0:3019 offline: Function names exposed for local invocation by aws-sdk: * authEndpoint: serverless-express-auth-dev-authEndpoint * hello: serverless-express-auth-dev-hello [offline] Lambda Invocation Routes (for AWS SDK or AWS CLI): * POST http://0.0.0.0:3019/2015-03-31/functions/serverless-express-auth-dev-authEndpoint/invocations * POST http://0.0.0.0:3019/2015-03-31/functions/serverless-express-auth-dev-hello/invocations [offline] Lambda Async Invocation Routes (for AWS SDK or AWS CLI): * POST http://0.0.0.0:3019/2014-11-13/functions/serverless-express-auth-dev-authEndpoint/invoke-async/ * POST http://0.0.0.0:3019/2014-11-13/functions/serverless-express-auth-dev-hello/invoke-async/ offline: Configuring Authorization: hello authEndpoint [offline] Creating Authorization scheme for hello-authEndpoint-GET-hello \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502 GET | http://0.0.0.0:3003/dev/hello \u2502 \u2502 POST | http://0.0.0.0:3003/2015-03-31/functions/hello/invocations \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 offline: [HTTP] server ready: http://0.0.0.0:3003 \ud83d\ude80 offline: offline: Enter \"rp\" to replay the last request \u6b65\u9aa4 4. \u5728\u672c\u5730\u73af\u5883\u8fd0\u884cVue UI cd tutorials/api-gateway/vue-ui yarn yarn serve \u8f93\u51fa\u793a\u4f8b yarn run v1.22.19 $ vue-cli-service serve Browserslist: caniuse-lite is outdated. Please run: npx browserslist@latest --update-db Why you should do it regularly: https://github.com/browserslist/browserslist#browsers-data-updating INFO Starting development server... Starting type checking service... Using 1 worker with 2048MB memory limit 98% after emitting CopyPlugin DONE Compiled successfully in 1638ms 3:42:04 PM No type errors found Version: typescript 4.2.4 Time: 1111ms App running at: - Local: http://localhost:8080/ - Network: http://localhost:8080/ Note that the development build is not optimized. To create a production build, run yarn build. \u6b65\u9aa4 5. \u9a8c\u8bc1\u7528\u6237\u6743\u9650 \u4e00\u4e2a\u5e38\u89c1\u7684\u573a\u666f\u662f\u4e0d\u540c\u7684\u7528\u6237\u6709\u4e0d\u540c\u7684\u6743\u9650\u6765\u6267\u884c\u4e00\u4e2a\u52a8\u4f5c\uff08\u5141\u8bb8/\u62d2\u7edd\uff09\u3002\u6b64\u6559\u7a0b\u4e2d\u5185\u7f6e\u4e86\u4e24\u4e2a\u4e0d\u540c\u7684\u7528\u6237\uff0cuser1 \u53ef\u4ee5\u8c03\u7528 API gateway\uff0c\u800c user2 \u4e0d\u5141\u8bb8\u3002 \u7528\u6237\u8be6\u7ec6\u4fe1\u606f\u5982\u4e0b: \u7528\u6237\u540d \u5bc6\u7801 \u89d2\u8272 \u63cf\u8ff0 user1 user1 call-api user1 \u5141\u8bb8\u8c03\u7528 API gateway user2 user2 - user2 \u4e0d\u5141\u8bb8\u8c03\u7528 API gateway \u6253\u5f00 Vue UI \u63a7\u5236\u53f0\uff0c\u4f8b\u5982 http://localhost:8080 \u3002 \u70b9\u51fb Login \u3002 \u5728 Username or email\u4e2d \u8f93\u5165 user1 \uff0c\u5728 Password \u4e2d\u8f93\u5165 user1 \u3002 \u9009\u62e9 Sign In \u3002 \u9009\u62e9 Request \uff0c\u60a8\u5c06\u83b7\u5f97\u6210\u529f\u7684\u54cd\u5e94\u6d88\u606f\u3002 { \"url\": \"http://localhost:3003/dev/hello\", \"status\": 200, \"statusText\": \"OK\", \"data\": { \"message\": \"Hello World from protect server\" } } \u70b9\u51fb Logout . \u5728 Username or email\u4e2d \u8f93\u5165 user2 \uff0c\u5728 Password \u4e2d\u8f93\u5165 user2 \u3002 \u9009\u62e9 Sign In \u3002 \u9009\u62e9 Request \uff0c\u60a8\u5c06\u83b7\u5f97\u5931\u8d25\u7684\u54cd\u5e94\u6d88\u606f\uff0c\u72b6\u6001\u7801\u4e3a 401\u3002 { \"url\": \"http://localhost:3003/dev/hello\", \"status\": 401, \"statusText\": \"Unauthorized\", \"data\": { \"statusCode\": 401, \"error\": \"Unauthorized\", \"message\": \"Unauthorized\" } } \u5e38\u89c1\u95ee\u9898\u89e3\u7b54 1. \u5982\u4f55\u5bfc\u51fa Keycloak \u57df\u7528\u6237\uff1f \u8be6\u60c5\u8bf7\u53c2\u8003\uff1a<https://stackoverflow.com/questions/60766292/how-to-get-keycloak-to-export-realm-users-and-then-exit> $ docker exec <container id> $ /opt/jboss/keycloak/bin/standalone.sh -Dkeycloak.migration.action=export -Dkeycloak.migration.realmName=keycloak-on-aws -Dkeycloak.migration.provider=singleFile -Dkeycloak.migration.provider=singleFile -Dkeycloak.migration.file=realm-export.json -Djboss.socket.binding.port-offset=99","title":"\u5982\u4f55\u5c06 Keycloak \u4e0e Amazon API Gateway \u96c6\u6210\uff1f"},{"location":"implementation-guide/tutorials/api-gateway/#keycloak-amazon-api-gateway","text":"\u672c\u6559\u7a0b\u4ecb\u7ecd\u5982\u4f55\u901a\u8fc7 Keycloak \u63a7\u5236\u4e0d\u540c\u7528\u6237\u8bbf\u95ee\u4e0d\u540cAPI\u63a5\u53e3\u7684\u6743\u9650\u3002\u66f4\u591a\u4fe1\u606f\u53ef\u4ee5\u53c2\u8003 Keycloak \u6587\u6863\u7684 Authorization Services \u7ae0\u8282\u3002","title":"\u6559\u7a0b: \u5982\u4f55\u5c06 Keycloak \u4e0e Amazon API Gateway \u96c6\u6210\uff1f"},{"location":"implementation-guide/tutorials/api-gateway/#_1","text":"","title":"\u67b6\u6784\u56fe"},{"location":"implementation-guide/tutorials/api-gateway/#_2","text":"\u60a8\u5df2\u7ecf\u901a\u8fc7 AWS CloudFormation \u6216 AWS CDK \u90e8\u7f72\u4e86\u89e3\u51b3\u65b9\u6848\uff0c\u5e76\u4e14\u5df2\u7ecf\u4ee5 Keycloak \u7ba1\u7406\u5458\u7528\u6237\u8eab\u4efd\u6210\u529f\u767b\u5f55 Keycloak \u4eea\u8868\u677f\u3002 \u786e\u4fdd\u5728 CloudFormation \u53c2\u6570\u4e2d\u586b\u5199\u4e86\u4ee5\u4e0b JAVA_OPTS\u3002 -Dkeycloak.profile.feature.scripts=enabled -Dkeycloak.profile.feature.upload_scripts=enabled","title":"\u524d\u63d0\u6761\u4ef6"},{"location":"implementation-guide/tutorials/api-gateway/#_3","text":"\u6b65\u9aa4 1. \u514b\u9686keycloak-on-aws\u4ee3\u7801\u81f3\u672c\u5730 \u6b65\u9aa4 2. \u5bfc\u5165Keycloak\u793a\u4f8b\u914d\u7f6e\u6587\u4ef6 \u6b65\u9aa4 3. \u5728\u672c\u5730\u73af\u5883\u8fd0\u884cserverless-express-auth \u6b65\u9aa4 4. \u5728\u672c\u5730\u73af\u5883\u8fd0\u884cVue UI \u6b65\u9aa4 5. \u9a8c\u8bc1\u7528\u6237\u6743\u9650","title":"\u64cd\u4f5c\u6b65\u9aa4"},{"location":"implementation-guide/tutorials/api-gateway/#1-keycloak-on-aws","text":"\u6267\u884c\u4ee5\u4e0b\u547d\u4ee4\u5c06 keycloak-on-aws \u4ee3\u7801\u4e0b\u8f7d\u5230\u672c\u5730\u3002 git clone https://github.com/aws-samples/keycloak-on-aws.git cd keycloak-on-aws","title":"\u6b65\u9aa4 1. \u514b\u9686keycloak-on-aws\u4ee3\u7801\u81f3\u672c\u5730"},{"location":"implementation-guide/tutorials/api-gateway/#2-keycloak","text":"\u4ee5 Keycloak \u7ba1\u7406\u5458\u7528\u6237\u8eab\u4efd\u767b\u5f55 Keycloak \u4eea\u8868\u677f\u3002 \u5728\u5de6\u4fa7\u5bfc\u822a\u7a97\u4e2d\u7684 Master \uff0c\u9009\u62e9 Add realm \u3002 \u9009\u62e9 Select file \uff0c\u9009\u4e2d\u6b65\u9aa4 1 \u4e0b\u8f7d\u4ee3\u7801\u4e2d\u7684 tutorials/api-gateway/resoures/realm-export.json \u6587\u4ef6 \u3002 \u9009\u62e9 Create \u3002","title":"\u6b65\u9aa4 2. \u5bfc\u5165Keycloak\u793a\u4f8b\u914d\u7f6e\u6587\u4ef6"},{"location":"implementation-guide/tutorials/api-gateway/#3-serverless-express-auth","text":"\u8be5\u793a\u4f8b\u4e3b\u8981\u57fa\u4e8e expressjs \u548c\u5b98\u65b9\u7684 keycloak-nodejs-connect \uff0c\u5e76\u4f7f\u7528 serverless-express \u4ece\u800c\u8ba9 expressjs \u80fd\u591f\u5728 Lambda \u4e0a\u8fd0\u884c\u3002 keycloak-nodejs-connect \u7531 Keycloak \u56e2\u961f\u7ef4\u62a4\uff0c\u8fd9\u662f\u8fde\u63a5\u5230 Keycloak \u7684\u63a8\u8350\u65b9\u5f0f\u3002 \u8bf4\u660e keycloak-nodejs-connect\u7684\u6587\u4ef6\u4f4d\u4e8e https://www.keycloak.org/docs/latest/securing_apps/#_nodejs_adapter\u3002 \u4ee5 Keycloak \u7ba1\u7406\u5458\u7528\u6237\u8eab\u4efd\u767b\u5f55 Keycloak \u4eea\u8868\u677f\u3002 \u5728\u5de6\u4fa7\u7684\u5bfc\u822a\u7a97\u4e2d\u9009\u62e9 Clients \u3002 \u9009\u62e9 vue \u67e5\u770b\u8be6\u7ec6\u4fe1\u606f\u3002 \u9009\u62e9 Installation \u3002 \u70b9\u51fb Format Option \u4e0b\u62c9\u83dc\u5355\u5e76\u9009\u62e9 Keycloak OIDC JSON \u3002 \u6839\u636e Keyloak Installation \u4e2d\u7684\u914d\u7f6e\u66f4\u65b0\u6b65\u9aa4 1 \u4e0b\u8f7d\u4ee3\u7801\u4e2d tutorials/api-gateway/resources/realm-export.json \u6587\u4ef6\u5185\u5bb9 \u3002 { \"realm\": \"keycloak-on-aws\", \"auth-server-url\": \"https://keycloak.yourdomain.com/auth/\", \"ssl-required\": \"external\", \"resource\": \"vue\", \"public-client\": true, \"confidential-port\": 0, // Don't remove the following line, this is for vue-ui to contact to api gw !!! \"x-api-gw-url\": \"http://localhost:3003/dev/hello\" } \u8fdb\u5165 tutorials/api-gateway/serverless-express-auth \u76ee\u5f55\uff0c\u5e76\u6267\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a cd tutorials/api-gateway/serverless-express-auth yarn yarn offline \u8f93\u51fa\u793a\u4f8b yarn run v1.22.19 $ SLS_DEBUG=* serverless offline --host 0.0.0.0 --httpPort 3003 --lambdaPort=3019 ... offline: Offline [http for lambda] listening on http://0.0.0.0:3019 offline: Function names exposed for local invocation by aws-sdk: * authEndpoint: serverless-express-auth-dev-authEndpoint * hello: serverless-express-auth-dev-hello [offline] Lambda Invocation Routes (for AWS SDK or AWS CLI): * POST http://0.0.0.0:3019/2015-03-31/functions/serverless-express-auth-dev-authEndpoint/invocations * POST http://0.0.0.0:3019/2015-03-31/functions/serverless-express-auth-dev-hello/invocations [offline] Lambda Async Invocation Routes (for AWS SDK or AWS CLI): * POST http://0.0.0.0:3019/2014-11-13/functions/serverless-express-auth-dev-authEndpoint/invoke-async/ * POST http://0.0.0.0:3019/2014-11-13/functions/serverless-express-auth-dev-hello/invoke-async/ offline: Configuring Authorization: hello authEndpoint [offline] Creating Authorization scheme for hello-authEndpoint-GET-hello \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510 \u2502 \u2502 \u2502 GET | http://0.0.0.0:3003/dev/hello \u2502 \u2502 POST | http://0.0.0.0:3003/2015-03-31/functions/hello/invocations \u2502 \u2502 \u2502 \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518 offline: [HTTP] server ready: http://0.0.0.0:3003 \ud83d\ude80 offline: offline: Enter \"rp\" to replay the last request","title":"\u6b65\u9aa4 3. \u5728\u672c\u5730\u73af\u5883\u8fd0\u884cserverless-express-auth"},{"location":"implementation-guide/tutorials/api-gateway/#4-vue-ui","text":"cd tutorials/api-gateway/vue-ui yarn yarn serve \u8f93\u51fa\u793a\u4f8b yarn run v1.22.19 $ vue-cli-service serve Browserslist: caniuse-lite is outdated. Please run: npx browserslist@latest --update-db Why you should do it regularly: https://github.com/browserslist/browserslist#browsers-data-updating INFO Starting development server... Starting type checking service... Using 1 worker with 2048MB memory limit 98% after emitting CopyPlugin DONE Compiled successfully in 1638ms 3:42:04 PM No type errors found Version: typescript 4.2.4 Time: 1111ms App running at: - Local: http://localhost:8080/ - Network: http://localhost:8080/ Note that the development build is not optimized. To create a production build, run yarn build.","title":"\u6b65\u9aa4 4. \u5728\u672c\u5730\u73af\u5883\u8fd0\u884cVue UI"},{"location":"implementation-guide/tutorials/api-gateway/#5","text":"\u4e00\u4e2a\u5e38\u89c1\u7684\u573a\u666f\u662f\u4e0d\u540c\u7684\u7528\u6237\u6709\u4e0d\u540c\u7684\u6743\u9650\u6765\u6267\u884c\u4e00\u4e2a\u52a8\u4f5c\uff08\u5141\u8bb8/\u62d2\u7edd\uff09\u3002\u6b64\u6559\u7a0b\u4e2d\u5185\u7f6e\u4e86\u4e24\u4e2a\u4e0d\u540c\u7684\u7528\u6237\uff0cuser1 \u53ef\u4ee5\u8c03\u7528 API gateway\uff0c\u800c user2 \u4e0d\u5141\u8bb8\u3002 \u7528\u6237\u8be6\u7ec6\u4fe1\u606f\u5982\u4e0b: \u7528\u6237\u540d \u5bc6\u7801 \u89d2\u8272 \u63cf\u8ff0 user1 user1 call-api user1 \u5141\u8bb8\u8c03\u7528 API gateway user2 user2 - user2 \u4e0d\u5141\u8bb8\u8c03\u7528 API gateway \u6253\u5f00 Vue UI \u63a7\u5236\u53f0\uff0c\u4f8b\u5982 http://localhost:8080 \u3002 \u70b9\u51fb Login \u3002 \u5728 Username or email\u4e2d \u8f93\u5165 user1 \uff0c\u5728 Password \u4e2d\u8f93\u5165 user1 \u3002 \u9009\u62e9 Sign In \u3002 \u9009\u62e9 Request \uff0c\u60a8\u5c06\u83b7\u5f97\u6210\u529f\u7684\u54cd\u5e94\u6d88\u606f\u3002 { \"url\": \"http://localhost:3003/dev/hello\", \"status\": 200, \"statusText\": \"OK\", \"data\": { \"message\": \"Hello World from protect server\" } } \u70b9\u51fb Logout . \u5728 Username or email\u4e2d \u8f93\u5165 user2 \uff0c\u5728 Password \u4e2d\u8f93\u5165 user2 \u3002 \u9009\u62e9 Sign In \u3002 \u9009\u62e9 Request \uff0c\u60a8\u5c06\u83b7\u5f97\u5931\u8d25\u7684\u54cd\u5e94\u6d88\u606f\uff0c\u72b6\u6001\u7801\u4e3a 401\u3002 { \"url\": \"http://localhost:3003/dev/hello\", \"status\": 401, \"statusText\": \"Unauthorized\", \"data\": { \"statusCode\": 401, \"error\": \"Unauthorized\", \"message\": \"Unauthorized\" } }","title":"\u6b65\u9aa4 5. \u9a8c\u8bc1\u7528\u6237\u6743\u9650"},{"location":"implementation-guide/tutorials/api-gateway/#_4","text":"1. \u5982\u4f55\u5bfc\u51fa Keycloak \u57df\u7528\u6237\uff1f \u8be6\u60c5\u8bf7\u53c2\u8003\uff1a<https://stackoverflow.com/questions/60766292/how-to-get-keycloak-to-export-realm-users-and-then-exit> $ docker exec <container id> $ /opt/jboss/keycloak/bin/standalone.sh -Dkeycloak.migration.action=export -Dkeycloak.migration.realmName=keycloak-on-aws -Dkeycloak.migration.provider=singleFile -Dkeycloak.migration.provider=singleFile -Dkeycloak.migration.file=realm-export.json -Djboss.socket.binding.port-offset=99","title":"\u5e38\u89c1\u95ee\u9898\u89e3\u7b54"}]}